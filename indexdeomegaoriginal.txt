<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=1280, user-scalable=yes">
    <title>OMEGA BINGO</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
    
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    
    <script src="firebase-config.js"></script>
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #7e22cf 0%, #6c1eac 50%, #5a1c8a 100%);
            min-height: 100vh;
        }
        
        /* Header Profesional */
        .main-header {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            position: sticky;
            top: 0;
            z-index: 999;
        }
        
        .nav-link {
            padding: 0.75rem 1.5rem;
            color: #e0e0e0;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
        }
        
        .nav-link:hover {
            color: #fcd34d;
            border-bottom-color: #fcd34d;
        }
        
        /* ============================================ */
        /* SECCI√ìN HERO - CARRUSEL DE PUBLICIDAD */
        /* ============================================ */
        .hero-section {
            padding: 0;
            position: relative;
            overflow: hidden;
            background: #fff093;
        }
        
        .hero-carousel-container {
            position: relative;
            width: 100%;
            height: 500px;
            overflow: hidden;
        }
        
        .hero-carousel {
            display: flex;
            transition: transform 0.6s ease-in-out;
            height: 100%;
        }
        
        .hero-slide {
            min-width: 100%;
            height: 100%;
            position: relative;
            cursor: pointer;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }
        
        .hero-slide::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(to bottom, rgba(0,0,0,0.3), rgba(0,0,0,0.5));
        }
        
        .carousel-dots {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
            z-index: 10;
        }
        
        .carousel-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255,255,255,0.5);
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .carousel-dot.active {
            background: #fcd34d;
            transform: scale(1.3);
        }
        
        .carousel-arrow {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(0,0,0,0.5);
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 20px;
            z-index: 10;
            transition: all 0.3s;
        }
        
        .carousel-arrow:hover {
            background: rgba(252, 211, 77, 0.9);
            color: #1f2937;
        }
        
        .carousel-arrow.prev { left: 20px; }
        .carousel-arrow.next { right: 20px; }
        
        /* ============================================ */
        /* CARRUSEL DE PUBLICIDAD ADICIONAL */
        /* ============================================ */
        .publicity-carousel-section {
            padding: 3rem 0;
            background: #f3f4f6;
            overflow: hidden;
        }
        
        .publicity-carousel {
            display: flex;
            animation: scroll-publicity 15s linear infinite;
            gap: 2rem;
        }
        
        @media (hover: hover) {
        .publicity-carousel:hover {
        animation-play-state: paused;
        }
        }

        
        .publicity-item {
            min-width: 400px;
            height: 400px;
            border-radius: 1rem;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            cursor: pointer;
            transition: transform 0.3s;
            background-size: cover;
            background-position: center;
        }
        
        .publicity-item:hover {
            transform: scale(1.05);
        }
        
        @keyframes scroll-publicity {
        0% { transform: translateX(0); }
        /* Mueve exactamente la longitud de los 7 √≠tems originales */
        100% { transform: translateX(-1700px); } 
        }

        /* ============================================ */
/* BARRA DE GANADORES ANIMADA */
/* ============================================ */
.winners-ticker {
    background: linear-gradient(135deg, #fcd34d 0%, #f59e0b 100%);
    padding: 1rem 0;
    /* --- ARREGLO CLAVE: A√±adido el punto y coma (;) --- */
    height: 360px; 
    overflow: hidden; /* <--- Ahora esto funcionar√° y cortar√° el contenido */
    /* ------------------------------------------------ */
    position: relative;
    border-top: 3px solid #1f2937;
    border-bottom: 3px solid #1f2937;
}

.winners-track {
    display: flex;
    flex-direction: column;
    animation: scroll-winners 20s linear infinite;
}

.winner-item {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 0.75rem 2rem;
    background: rgba(255,255,255,0.9);
    margin-bottom: 0.5rem;
    border-radius: 0.5rem;
    min-height: 60px;
}

.winner-icon {
    /* Estos estilos volver√°n a hacer las im√°genes circulares */
    width: 40px;
    height: 40px;
    border-radius: 50%;
    object-fit: cover;
    border: 2px solid #fcd34d;
}

.winner-info {
    flex: 1;
}

.winner-name {
    /* Estos estilos volver√°n a formatear el texto */
    font-weight: 900;
    color: #1f2937;
    font-size: 0.9rem;
}

.winner-prize {
    /* Estos estilos volver√°n a formatear el premio */
    font-weight: 600;
    color: #059669;
    font-size: 0.85rem;
}

@keyframes scroll-winners {
    0% { transform: translateY(0); }
    100% { transform: translateY(-50%); }
}

        /* Salas de Bingo */
        .sala-card {
            background: linear-gradient(145deg, #ffffff 0%, #f3f4f6 100%);
            border-radius: 1.5rem;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: transform 0.3s, box-shadow 0.3s;
            position: relative;
        }
        
        .sala-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }
        
        .sala-badge {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: linear-gradient(135deg, #fcd34d 0%, #f59e0b 100%);
            color: #1f2937;
            padding: 0.5rem 1rem;
            border-radius: 2rem;
            font-weight: 900;
            font-size: 0.875rem;
            box-shadow: 0 4px 10px rgba(252, 211, 77, 0.4);
            z-index: 2;
        }
        
        .bote-amount {
            font-size: 2.5rem;
            font-weight: 900;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        /* ============================================ */
        /* IMAGEN DE SALAS - USA TU PNG */
        /* ============================================ */
        .sala-image-container {
            height: 200px;
            position: relative;
            overflow: hidden;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }
        
        .sala-icon {
            font-size: 5rem;
            color: rgba(255,255,255,0.9);
            z-index: 1;
        }
        
        /* Botones Premium */
        .btn-premium {
            background: linear-gradient(135deg, #01ce2f 0%, #00b001 100%);
            color: #ffffff;
            padding: 1rem 2rem;
            border-radius: 0.75rem;
            font-weight: 900;
            text-transform: uppercase;
            box-shadow: 0 6px 20px rgba(252, 211, 77, 0.4);
            transition: all 0.3s;
            border: none;
            cursor: pointer;
        }
        
        .btn-premium:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(252, 211, 77, 0.6);
        }

        /* Botones Premium */
        .btn-premium2 {
            background: linear-gradient(135deg, #fcd34d 0%, #f59e0b 100%);
            color: #1f2937;
            padding: 1rem 2rem;
            border-radius: 0.75rem;
            font-weight: 900;
            text-transform: uppercase;
            box-shadow: 0 6px 20px rgba(252, 211, 77, 0.4);
            transition: all 0.3s;
            border: none;
            cursor: pointer;
        }
        
        .btn-premium:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(252, 211, 77, 0.6);
        }
        
        /* Tablas de Bingo */
        .bingo-card-image { 
            max-width: 100%; 
            height: auto; 
            border-radius: 0.75rem; 
            border: 4px solid #800080; 
            box-shadow: 0 10px 25px rgba(0,0,0,0.4); 
        }
        
        /* Modal */
        .modal { 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            background-color: rgba(0,0,0,0.85); 
            display: none; 
            justify-content: center; 
            align-items: center; 
            z-index: 1000; 
            overflow-y: auto; 
            padding: 20px 0; 
        }
        
        .modal-content { 
            background-color: white; 
            border-radius: 1rem; 
            padding: 1.5rem; 
            width: 90%; 
            max-width: 500px; 
            box-shadow: 0 25px 50px -12px rgba(0,0,0,0.5); 
            position: relative; 
        }
        
        .modal-legal-content { 
            background-color: white; 
            border-radius: 1rem; 
            padding: 1.5rem; 
            width: 95%; 
            max-width: 800px; 
            box-shadow: 0 25px 50px -12px rgba(0,0,0,0.5); 
            position: relative; 
            max-height: 90vh; 
        }
        
        .modal-legal-body { 
            overflow-y: auto; 
            max-height: 70vh; 
            padding: 1rem 0;
        }
        
        /* Overlay de Juego Cerrado */
        .closed-overlay { 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            background-color: white;
            display: none; 
            flex-direction: column; 
            justify-content: center; 
            align-items: center; 
            z-index: 9999; 
            text-align: center; 
            color: #1f2937;
        }
        
        canvas {
            border-bottom: 2px solid #5b21b6;
            background: transparent;
            touch-action: manipulation;
        }
        
        /* Botones de Bingo */
        .card-item-container { 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            padding: 2px; 
            cursor: pointer; 
            transition: transform 0.1s; 
        }
        
        .card-item-container:hover { 
            transform: scale(1.05); 
        }
        
        .bingo-ball { 
            width: 48px; 
            height: 48px; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            font-size: 18px; 
            font-weight: 900; 
            border-radius: 50%; 
            box-shadow: 0 4px 6px rgba(0,0,0,0.2); 
            z-index: 2; 
            position: relative;
        }
        
        .ver-tag { 
            font-size: 10px; 
            font-weight: bold; 
            background-color: #fcd34d; 
            color: #1f2937; 
            padding: 1px 6px; 
            margin-top: 4px; 
            border-radius: 4px; 
            border: 1px solid #fbbf24; 
            z-index: 2; 
            position: relative; 
        }
        
        .ver-tag:hover { 
            background-color: #fbbf24; 
        }
        
        /* Estados de Color */
        .status-available .bingo-ball { 
            background-color: #6b21a8; 
            color: white; 
            border: 2px solid #5b21b6; 
        }
        
        .status-selected .bingo-ball { 
            background-color: #fcd34d; 
            color: #1f2937; 
            border: 2px solid #fbbf24; 
            transform: scale(1.1); 
        }
        
        .status-reserved .bingo-ball { 
            background-color: #f97316; 
            color: white; 
            border: 2px solid #ea580c; 
            animation: pulse-orange 2s infinite; 
        }
        
        .status-sold .bingo-ball { 
            background-color: #16a34a; 
            color: white; 
            border: 2px solid #15803d; 
        }
        
        @keyframes pulse-orange { 
            0% { box-shadow: 0 0 0 0 rgba(249, 115, 22, 0.7); } 
            70% { box-shadow: 0 0 0 10px rgba(249, 115, 22, 0); } 
            100% { box-shadow: 0 0 0 0 rgba(249, 115, 22, 0); } 
        }
        
        /* Admin Panel */
        .admin-panel { 
            min-height: 100vh; 
            background: #f3f4f6; 
            padding: 2rem; 
        }
        
        /* Footer Profesional */
        .main-footer {
            background: linear-gradient(135deg, #1a1a2e 0%, #0f0c29 100%);
            color: #e0e0e0;
            padding: 3rem 0 1rem;
            margin-top: 4rem;
        }

/* ============================================ */
/* ESTILOS PARA RESERVA DE L√çNEAS */
/* ============================================ */

/* Tabs para l√≠neas */
.tab-line {
    transition: all 0.3s;
}

.tab-line.active {
    border-bottom-color: #7c3aed;
    color: #7c3aed;
    border-bottom-width: 3px;
}

.tab-content-line {
    min-height: 300px;
}

/* N√∫meros de l√≠nea */
.line-number-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 5px;
    cursor: pointer;
    transition: all 0.3s;
}

.line-number-container:hover {
    transform: scale(1.05);
}

.line-number {
    width: 60px;
    height: 60px;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 24px;
    font-weight: 900;
    border-radius: 50%;
    margin: 0 auto;
    box-shadow: 0 4px 6px rgba(0,0,0,0.2);
    transition: all 0.3s;
    position: relative;
    overflow: hidden;
}

.line-number::before {
    content: '';
    position: absolute;
    inset: 0;
    background: currentColor;
    opacity: 0.1;
}

.line-number.libre {
    background-color: #6b21a8;
    color: white;
    border: 3px solid #5b21b6;
}

.line-number.seleccionado {
    background-color: #fcd34d;
    color: #1f2937;
    border: 3px solid #fbbf24;
    transform: scale(1.1);
    animation: pulse-yellow 1.5s infinite;
}

.line-number.reservado {
    background-color: #f97316;
    color: white;
    border: 3px solid #ea580c;
    animation: pulse-orange 2s infinite;
}

.line-number.vendido {
    background-color: #16a34a;
    color: white;
    border: 3px solid #15803d;
}

@keyframes pulse-yellow {
    0% { box-shadow: 0 0 0 0 rgba(251, 191, 36, 0.7); }
    70% { box-shadow: 0 0 0 10px rgba(251, 191, 36, 0); }
    100% { box-shadow: 0 0 0 0 rgba(251, 191, 36, 0); }
}

/* Fondos para cada lista */
.line-bg-picante {
    background: linear-gradient(135deg, #ff6b6b 0%, #ff4757 100%);
}

.line-bg-comun {
    background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
}

.line-bg-fuego {
    background: linear-gradient(135deg, #ff9a00 0%, #ff5e00 100%);
}

.line-bg-dragon {
    background: linear-gradient(135deg, #9d50bb 0%, #6e48aa 100%);
}

/* Efectos de part√≠culas */
.particle {
    position: absolute;
    pointer-events: none;
    opacity: 0.7;
    z-index: 1000;
}

/* Notificaciones en tiempo real */
.line-notification {
    position: fixed;
    top: 20px;
    right: 20px;
    background: white;
    padding: 15px;
    border-radius: 10px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.3);
    z-index: 9999;
    animation: slideIn 0.5s ease-out;
    display: none;
}

@keyframes slideIn {
    from {
        transform: translateX(100%);
        opacity: 0;
    }
    to {
        transform: translateX(0);
        opacity: 1;
    }
}

.line-status-tag {
    font-size: 10px;
    font-weight: bold;
    padding: 2px 8px;
    margin-top: 4px;
    border-radius: 4px;
    z-index: 2;
}

/* Indicador de sala lista para jugar */
.sala-ready-indicator {
    position: absolute;
    top: -10px;
    right: -10px;
    width: 25px;
    height: 25px;
    background: #10b981;
    border-radius: 50%;
    animation: pulse-green 1s infinite;
    z-index: 10;
}

@keyframes pulse-green {
    0% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7); }
    70% { box-shadow: 0 0 0 10px rgba(16, 185, 129, 0); }
    100% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0); }
}

/* Animaci√≥n para liberar n√∫meros */
@keyframes liberate {
    0% { transform: scale(1); }
    50% { transform: scale(1.2); }
    100% { transform: scale(1); }
}

.line-liberating {
    animation: liberate 0.5s ease-in-out 3;
}

/* Estilos para el panel de admin de l√≠neas */
.admin-line-stats {
    transition: all 0.3s;
}

.admin-line-stats:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 20px rgba(0,0,0,0.1);
}

.line-stats-count {
    font-size: 1.5rem;
    font-weight: 900;
    margin-bottom: 0.5rem;
}

.line-stats-detail {
    font-size: 0.75rem;
    display: flex;
    justify-content: space-between;
    margin-top: 0.25rem;
}

/* Botones de acci√≥n admin */
.admin-action-btn {
    padding: 0.5rem 1rem;
    border-radius: 0.5rem;
    font-weight: bold;
    font-size: 0.75rem;
    transition: all 0.3s;
    cursor: pointer;
    border: none;
    margin-top: 0.5rem;
}

.admin-action-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
}

.btn-reset {
    background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
    color: white;
}

.btn-free {
    background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
    color: white;
}

/* Modal de liberar n√∫mero */
.free-number-grid {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 0.5rem;
}

.free-number-btn {
    padding: 0.75rem;
    border-radius: 0.5rem;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s;
    border: 2px solid transparent;
}

.free-number-btn:hover {
    opacity: 0.8;
    transform: scale(1.05);
}

/* Responsive para admin */
@media (max-width: 768px) {
    .admin-panel {
        padding: 1rem;
    }
    
    .free-number-grid {
        grid-template-columns: repeat(3, 1fr);
    }
}
        
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"/>
</head>
<body>
    <!-- OVERLAY DE TIENDA CERRADA CON JUEGO -->
        <div id="closedStoreOverlay" class="closed-overlay select-none">
        <div id="adminSecretLock" class="absolute top-5 right-5 text-gray-300 cursor-pointer p-2 opacity-30 hover:opacity-100 z-50">
            <i class="fas fa-lock fa-lg"></i>
        </div>

        <div class="relative w-full max-w-lg h-full flex flex-col justify-center items-center">
            <div class="absolute top-10 text-center w-full px-4">
                <h2 id="overlayTitle" class="text-2xl font-black text-purple-800 mb-1 uppercase tracking-wide">¬°A√∫n estamos cerrados!</h2>
                <p id="overlaySubtitle" class="text-gray-500 text-sm font-bold mb-2">Reservas a partir de las 8:00 AM</p>
                
                <div class="inline-block bg-yellow-400 text-purple-900 font-black px-4 py-1 rounded-full text-sm shadow-md">
                    SCORE: <span id="gameScore">0</span>
                </div>
            </div>

            <div class="relative w-full h-[300px] flex items-center justify-center bg-white overflow-hidden" id="gameContainer" onclick="jumpDino()">
                <canvas id="dinoCanvas"></canvas>
                
                <div id="gameMessage" class="absolute inset-0 flex flex-col items-center justify-center bg-white/80 z-10">
                    <p class="text-purple-800 font-black text-xl mb-2" id="msgTitle">¬°JUEGA MIENTRAS ESPERAS!</p>
                    <p class="text-gray-600 text-sm mb-4">Toca la pantalla para saltar</p>
                    <button onclick="startGame()" class="bg-purple-600 text-white font-bold py-2 px-6 rounded-full shadow-lg hover:scale-105 transition-transform animate-pulse">
                        EMPEZAR A CORRER üöÄ
                    </button>
                </div>
            </div>

            <p class="mt-8 text-gray-400 text-xs text-center px-6">
                ¬°Pr√≥ximo Bingo!<br>
                Domingo 23 de Diciembre 2025 - 8:00PM
            </p>
        </div>
    </div>

    <!-- PANEL ADMIN -->
    <div id="adminPanel" class="admin-panel hidden">
        <div class="max-w-4xl mx-auto">
            <div class="flex justify-between items-center mb-8 bg-white p-4 rounded-xl shadow-md">
                <h1 class="text-2xl font-extrabold text-purple-800">üîê Panel de Control OMEGA</h1>
                <button onclick="adminLogout()" class="px-4 py-2 bg-red-500 text-white font-bold rounded hover:bg-red-600">Salir</button>
            </div>

            <div id="adminLogin" class="max-w-md mx-auto bg-white p-8 rounded-xl shadow-lg">
                <h2 class="text-xl font-bold mb-4 text-gray-700">Iniciar Sesi√≥n Admin</h2>
                <input type="email" id="adminEmail" placeholder="Correo" class="w-full p-3 border rounded mb-3">
                <input type="password" id="adminPassword" placeholder="Contrase√±a" class="w-full p-3 border rounded mb-4">
                <button onclick="adminLogin()" class="w-full py-3 bg-purple-600 text-white font-bold rounded hover:bg-purple-700">ENTRAR</button>
                <p id="adminLoginError" class="text-red-500 text-sm mt-3 hidden"></p>
            </div>

            <div id="adminDashboard" class="hidden space-y-8">
                               
                <div class="bg-white p-6 rounded-xl shadow-lg border-t-8 border-purple-500">
    <h2 class="text-2xl font-bold text-gray-800 mb-4">üéØ Reservas de L√≠neas Pendientes (<span id="linePendingCount">0</span>)</h2>
    <div id="linePendingList" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
</div>

<div class="bg-white p-6 rounded-xl shadow-lg border-t-8 border-blue-500">
    <div class="flex justify-between items-center mb-4">
        <h2 class="text-2xl font-bold text-gray-800">üìä Estado de L√≠neas</h2>
        <button onclick="resetAllLines()" class="bg-red-500 text-white px-4 py-2 rounded font-bold hover:bg-red-600">
            Reiniciar Todas
        </button>
    </div>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
        <div class="bg-gradient-to-r from-red-50 to-red-100 p-4 rounded-lg">
            <h3 class="font-bold text-red-700">üå∂Ô∏è Picante</h3>
            <p id="lineStatsPicante" class="text-sm">Cargando...</p>
        </div>
        <div class="bg-gradient-to-r from-blue-50 to-blue-100 p-4 rounded-lg">
            <h3 class="font-bold text-blue-700">‚≠ê Com√∫n</h3>
            <p id="lineStatsComun" class="text-sm">Cargando...</p>
        </div>
        <div class="bg-gradient-to-r from-orange-50 to-orange-100 p-4 rounded-lg">
            <h3 class="font-bold text-orange-700">üî• Fuego</h3>
            <p id="lineStatsFuego" class="text-sm">Cargando...</p>
        </div>
        <div class="bg-gradient-to-r from-purple-50 to-purple-100 p-4 rounded-lg">
            <h3 class="font-bold text-purple-700">üêâ Drag√≥n</h3>
            <p id="lineStatsDragon" class="text-sm">Cargando...</p>
        </div>
    </div>
</div>
                
                <div class="bg-white p-6 rounded-xl shadow-lg border-t-8 border-purple-600 flex justify-between items-center">
                    <div>
                        <h2 class="text-xl font-bold text-gray-800">üõ†Ô∏è Modo Mantenimiento / Tienda</h2>
                        <p id="storeStatusText" class="text-sm font-bold mt-1">Cargando estado...</p>
                        <p class="text-xs text-gray-400 mt-1">Si activas Mantenimiento, solo T√ö ver√°s la p√°gina.</p>
                    </div>
                    <button id="toggleStoreBtn" onclick="toggleStoreStatus()" class="px-6 py-3 rounded-lg font-black text-white transition-colors shadow-lg bg-gray-400">
                        CARGANDO...
                    </button>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-lg border-t-8 border-yellow-400">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4 flex items-center">
                        ‚ö†Ô∏è Pagos Pendientes por Confirmar (<span id="pendingCount">0</span>)
                    </h2>
                    <div id="pendingCardsList" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-lg border-t-8 border-green-500">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-2xl font-bold text-gray-800">‚úÖ Historial de Ventas (<span id="soldCount">0</span>)</h2>
                        <button onclick="downloadSoldList()" class="bg-blue-600 text-white px-4 py-2 rounded font-bold hover:bg-blue-700">Descargar CSV</button>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="min-w-full text-sm text-left text-gray-600">
                            <thead class="bg-gray-100 uppercase font-bold">
                                <tr><th class="p-3">Nombre</th><th class="p-3">Tlf</th><th class="p-3">Tablas</th><th class="p-3">Acci√≥n</th></tr>
                            </thead>
                            <tbody id="soldPlayersTableBody" class="divide-y divide-gray-200"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- CONTENIDO PRINCIPAL DEL CLIENTE -->
    <div id="clientContent">
        <!-- HEADER PROFESIONAL -->
        <header class="main-header">
            <div class="max-w-7xl mx-auto px-4 py-3 flex justify-between items-center">
                <div class="flex items-center space-x-4">
                    <img src="logo-omega-bingo.png" alt="OMEGA Bingo" class="h-12 w-12 rounded-full bg-white p-1" id="header-logo" onclick="handleLogoClick()">
                    <div>
                        <h1 class="text-2xl font-black text-yellow-400" style="text-shadow: 2px 2px 0 #5b21b6;">OMEGA BINGO</h1>
                        <p class="text-xs text-gray-300 font-semibold">Sistema de Reserva Online</p>
                    </div>
                </div>
                <nav class="hidden md:flex space-x-1">
                    <a href="#inicio" class="nav-link">INICIO</a>
                    <a href="#salas" class="nav-link">SALAS</a>
                    <a href="#consultar" class="nav-link">CONSULTAR</a>
                    <a href="#contacto" class="nav-link">CONTACTO</a>
                </nav>
                <button onclick="showCardSelectionModal()" class="btn-premium2 text-sm px-4 py-2">
                    COMPRAR üéüÔ∏è
                </button>
            </div>
        </header>

        <!-- ============================================ -->
        <!-- HERO SECTION - CARRUSEL DE PUBLICIDAD PRINCIPAL -->
        <!-- EDITA AQU√ç LAS IM√ÅGENES Y LINKS DE TUS BANNERS -->
        <!-- ============================================ -->
        <section id="inicio" class="hero-section">
            <div class="hero-carousel-container">
                <!-- BOTONES DE NAVEGACI√ìN -->
                <button class="carousel-arrow prev" onclick="moveCarousel(-1)">‚Äπ</button>
                <button class="carousel-arrow next" onclick="moveCarousel(1)">‚Ä∫</button>
                
                <!-- CARRUSEL - EDITA LOS BANNERS AQU√ç -->
                <div class="hero-carousel" id="heroCarousel">
                    <!-- BANNER 1 - EDITA LA IMAGEN Y LINK -->
                    <div class="hero-slide" style="background-image: url('banerrey1.jpg')" onclick="showCardSelectionModal()">
                        <div class="max-w-7xl mx-auto px-4 h-full flex items-center justify-center relative z-10">
                            <div class="text-center text-white">
                                <h2 class="text-5xl md:text-6xl font-black mb-4" style="text-shadow: 3px 3px 0 rgba(0,0,0,0.5);">
                                    ¬°JUEGA x2 Y GANA x1!üéÅ
                                </h2>
                                <p class="text-xl mb-6">Compra dos tablas y te llevas una carta ¬°GRATIS!</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- BANNER 2 - EDITA LA IMAGEN Y LINK -->
                    <div class="hero-slide" style="background-image: url('banerrey2.jpg')" onclick="window.open('https://chat.whatsapp.com/EGGD8r6dpU3692oiXlsKAG', '_blank')">
                        <div class="max-w-7xl mx-auto px-4 h-full flex items-center justify-center relative z-10">
                            <div class="text-center text-white">
                                <h2 class="text-5xl md:text-6xl font-black mb-4" style="text-shadow: 3px 3px 0 rgba(0,0,0,0.5);">
                                    ¬°GANA EL BOTE NAVIDE√ëO!üéÑ
                                </h2>
                                <p class="text-xl mb-6">¬°5 Premios para ti!</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- BANNER 3 - EDITA LA IMAGEN Y LINK -->
                    <div class="hero-slide" style="background-image: url('banerrey3.jpg')" onclick="openLineReservationModal()">
                        <div class="max-w-7xl mx-auto px-4 h-full flex items-center justify-center relative z-10">
                            <div class="text-center text-white">
                                <h2 class="text-5xl md:text-6xl font-black mb-4" style="text-shadow: 3px 3px 0 rgba(0,0,0,0.5);">
                                    ¬°LAS 3 MAR√çAS!üî•üå∂Ô∏èüåü
                                </h2>
                                <p class="text-xl mb-6">La picante, la de fuego, y la com√∫n. </p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- BANNER 4 - EDITA LA IMAGEN Y LINK -->
                    <div class="hero-slide" style="background-image: url('banerrey4.jpg')" onclick="window.open('https://chat.whatsapp.com/CIL8NiFHcbvAQwEw9Xwfiq', '_blank')">
                        <div class="max-w-7xl mx-auto px-4 h-full flex items-center justify-center relative z-10">
                            <div class="text-center text-white">
                                <h2 class="text-5xl md:text-6xl font-black mb-4" style="text-shadow: 3px 3px 0 rgba(0,0,0,0.5);">
                                    ¬°HASTA EL AMANECER!ü´©
                                </h2>
                                <p class="text-xl mb-6">Juego de l√≠neas 24/7</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- INDICADORES (PUNTOS) -->
                <div class="carousel-dots" id="carouselDots"></div>
            </div>
            
            <!-- INFO DEL BINGO DEBAJO DEL CARRUSEL -->
            <div class="bg-gradient-to-r from-purple-900 to-purple-700 py-8">
                <div class="max-w-7xl mx-auto px-4">
                    <p class="text-xl text-center text-purple-100 mb-4 font-semibold">Pr√≥ximo Juego: <span id="bingoDateDisplay" class="text-yellow-300 font-black">--</span></p>
                    <div class="flex justify-center mb-6">
                        <div class="bg-white/10 backdrop-blur-md rounded-2xl p-6 border-2 border-white/20">
                            <p class="text-purple-200 text-sm font-bold mb-2 text-center">CUENTA REGRESIVA</p>
                            <div id="countdownTimer" class="text-5xl font-black text-yellow-300 text-center" style="text-shadow: 2px 2px 0 rgba(0,0,0,0.3);">--:--:--</div>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="bg-white/10 backdrop-blur-md rounded-xl p-4 border border-white/20 text-center">
                            <p class="text-white font-bold text-sm mb-1">VALOR TABLA</p>
                            <p class="text-3xl font-black text-yellow-400">Bs. 300,00</p>
                        </div>
                        <div class="bg-white/10 backdrop-blur-md rounded-xl p-4 border border-white/20 text-center">
                            <p class="text-white font-bold text-sm mb-1">DISPONIBLES</p>
                            <p class="text-3xl font-black text-blue-400"><span id="availableCount">--</span>/75</p>
                        </div>
                        <div class="bg-white/10 backdrop-blur-md rounded-xl p-4 border border-white/20 text-center">
                            <p class="text-white font-bold text-sm mb-1">PARTIDAS</p>
                            <p class="text-3xl font-black text-green-400">¬°EN VIVO POR WHATSAPP!üì±</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ============================================ -->
        <!-- BARRA DE GANADORES ANIMADA -->
        <!-- EDITA AQU√ç LA INFORMACI√ìN DE LOS GANADORES -->
        <!-- ============================================ -->
        <section class="winners-ticker">
            <div class="winners-track" id="winnersTrack">
                
                <div class="winner-item">
                    <img src="./ganadores/kiko.png" alt="Ganador" class="winner-icon">
                    <div class="winner-info">
                        <div class="winner-name">üèÜ Kiko - GANADOR EN BINGO LINEA PICANTE</div>
                        <div class="winner-prize">Premio: Bs. 1,500 - Fecha: 01/12/2025</div>
                    </div>
                </div>
                
                <div class="winner-item">
                    <img src="./ganadores/liliana.png" alt="Ganador" class="winner-icon">
                    <div class="winner-info">
                        <div class="winner-name">üèÜ Liliana - GANADOR EN BINGO LINEA COM√öN</div>
                        <div class="winner-prize">Premio: Bs. 400 - Fecha: 28/11/2025</div>
                    </div>
                </div>
                
                <div class="winner-item">
                    <img src="./ganadores/yulimar.png" alt="Ganador" class="winner-icon">
                    <div class="winner-info">
                        <div class="winner-name">üèÜ Yulimar - GANADOR EN BINGO LINEA DE FUEGO</div>
                        <div class="winner-prize">Premio: Bs. 500 - Fecha: 25/11/2025</div>
                    </div>
                </div>
                
                <div class="winner-item">
                    <img src="./ganadores/alexandra.png" alt="Ganador" class="winner-icon">
                    <div class="winner-info">
                        <div class="winner-name">üèÜ Alexandra - GANADOR EN BINGO LINEA PICANTE</div>
                        <div class="winner-prize">Premio: Bs. 4,200 - Fecha: 20/11/2025</div>
                    </div>
                </div>
                
                <div class="winner-item">
                    <img src="./ganadores/maria.png" alt="Ganador" class="winner-icon">
                    <div class="winner-info">
                        <div class="winner-name">üèÜ Mar√≠a - GANADOR EN BINGO LINEA PICANTE</div>
                        <div class="winner-prize">Premio: Bs. 5,000 - Fecha: 01/12/2025</div>
                    </div>
                </div>
                
                <div class="winner-item">
                    <img src="./ganadores/yargenis.png" alt="Ganador" class="winner-icon">
                    <div class="winner-info">
                        <div class="winner-name">üèÜ Yargenis - GANADOR EN BINGO LINEA COM√öN</div>
                        <div class="winner-prize">Premio: Bs. 10,000 - Fecha: 28/11/2025</div>
                    </div>
                </div>
                
                <div class="winner-item">
                    <img src="./ganadores/yajaira.png" alt="Ganador" class="winner-icon">
                    <div class="winner-info">
                        <div class="winner-name">üèÜ Yajaira - GANADOR EN BINGO TRADICIONAL</div>
                        <div class="winner-prize">Premio: Bs. 1,500 - Fecha: 25/11/2025</div>
                    </div>
                </div>

                <div class="winner-item">
                    <img src="./ganadores/gabriela.png" alt="Ganador" class="winner-icon">
                    <div class="winner-info">
                        <div class="winner-name">üèÜ Gabriela- GANADOR EN BINGO LINEA DE FUEGO</div>
                        <div class="winner-prize">Premio: Bs. 1,000 - Fecha: 25/11/2025</div>
                    </div>
                </div>
                
                <div class="winner-item">
                    <img src="./ganadores/mayra.png" alt="Ganador" class="winner-icon">
                    <div class="winner-info">
                        <div class="winner-name">üèÜ Mayra - GANADOR EN BINGO LINEA PICANTE</div>
                        <div class="winner-prize">Premio: Bs. 500 - Fecha: 25/11/2025</div>
                    </div>
                </div>
                
                <div class="winner-item">
                    <img src="./ganadores/naileth.png" alt="Ganador" class="winner-icon">
                    <div class="winner-info">
                        <div class="winner-name">üèÜ Naileth - GANADOR EN BINGO LINEA PICANTE</div>
                        <div class="winner-prize">Premio: Bs. 700 - Fecha: 20/11/2025</div>
                    </div>
                </div>
          
            <div class="winner-item">
                    <img src="./ganadores/kiko.png" alt="Ganador" class="winner-icon">
                    <div class="winner-info">
                        <div class="winner-name">üèÜ Kiko - GANADOR EN BINGO LINEA PICANTE</div>
                        <div class="winner-prize">Premio: Bs. 1,500 - Fecha: 01/12/2025</div>
                    </div>
                </div>
                
                <div class="winner-item">
                    <img src="./ganadores/liliana.png" alt="Ganador" class="winner-icon">
                    <div class="winner-info">
                        <div class="winner-name">üèÜ Liliana - GANADOR EN BINGO LINEA COM√öN</div>
                        <div class="winner-prize">Premio: Bs. 400 - Fecha: 28/11/2025</div>
                    </div>
                </div>
                
                <div class="winner-item">
                    <img src="./ganadores/yulimar.png" alt="Ganador" class="winner-icon">
                    <div class="winner-info">
                        <div class="winner-name">üèÜ Yulimar - GANADOR EN BINGO LINEA DE FUEGO</div>
                        <div class="winner-prize">Premio: Bs. 500 - Fecha: 25/11/2025</div>
                    </div>
                </div>
                
                <div class="winner-item">
                    <img src="./ganadores/alexandra.png" alt="Ganador" class="winner-icon">
                    <div class="winner-info">
                        <div class="winner-name">üèÜ Alexandra - GANADOR EN BINGO LINEA PICANTE</div>
                        <div class="winner-prize">Premio: Bs. 4,200 - Fecha: 20/11/2025</div>
                    </div>
                </div>
                
                <div class="winner-item">
                    <img src="./ganadores/maria.png" alt="Ganador" class="winner-icon">
                    <div class="winner-info">
                        <div class="winner-name">üèÜ Mar√≠a - GANADOR EN BINGO LINEA PICANTE</div>
                        <div class="winner-prize">Premio: Bs. 450 - Fecha: 18/12/2025</div>
                    </div>
                </div>
                
                <div class="winner-item">
                    <img src="./ganadores/yargenis.png" alt="Ganador" class="winner-icon">
                    <div class="winner-info">
                        <div class="winner-name">üèÜ Yargenis - GANADOR EN BINGO LINEA COM√öN</div>
                        <div class="winner-prize">Premio: Bs. 10,000 - Fecha: 28/11/2025</div>
                    </div>
                </div>
                
                <div class="winner-item">
                    <img src="./ganadores/yajaira.png" alt="Ganador" class="winner-icon">
                    <div class="winner-info">
                        <div class="winner-name">üèÜ Yajaira - GANADOR EN BINGO TRADICIONAL</div>
                        <div class="winner-prize">Premio: Bs. 1,500 - Fecha: 25/11/2025</div>
                    </div>
                </div>

                <div class="winner-item">
                    <img src="./ganadores/gabriela.png" alt="Ganador" class="winner-icon">
                    <div class="winner-info">
                        <div class="winner-name">üèÜ Gabriela- GANADOR EN BINGO LINEA DE FUEGO</div>
                        <div class="winner-prize">Premio: Bs. 1,000 - Fecha: 25/11/2025</div>
                    </div>
                </div>
                
                <div class="winner-item">
                    <img src="./ganadores/mayra.png" alt="Ganador" class="winner-icon">
                    <div class="winner-info">
                        <div class="winner-name">üèÜ Mayra - GANADOR EN BINGO LINEA PICANTE</div>
                        <div class="winner-prize">Premio: Bs. 200 - Fecha: 18/12/2025</div>
                    </div>
                </div>
                
                <div class="winner-item">
                    <img src="./ganadores/naileth.png" alt="Ganador" class="winner-icon">
                    <div class="winner-info">
                        <div class="winner-name">üèÜ Naileth - GANADOR EN BINGO LINEA PICANTE</div>
                        <div class="winner-prize">Premio: Bs. 700 - Fecha: 20/11/2025</div>
                    </div>
                </div>
         
            </div>
        </section>

        <!-- ============================================ -->
        <!-- SECCI√ìN DE SALAS DE BINGO -->
        <!-- EDITA AQU√ç LAS IM√ÅGENES DE CADA SALA -->
        <!-- ============================================ -->
        <section id="salas" class="max-w-7xl mx-auto px-4 py-16">
            <div class="text-center mb-12">
                <h2 class="text-4xl font-black text-white mb-4">NUESTRAS SALAS DE BINGO</h2>
                <p class="text-gray-300 text-lg">¬°Elige tu sala favorita y comienza a jugar!</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- ========== SALA 1: OMEGA MAYOR ========== -->
                <!-- EDITA LA IMAGEN DE FONDO AQU√ç -->
                <div class="sala-card">
                    <div class="sala-badge">üèÜ PRINCIPAL</div>
                    <!-- CAMBIA "sala-omega-mayor.png" POR TU IMAGEN -->
                    <div class="sala-image-container" style="background-image: url('banersala75omega.png')">
                        <!-- Si no hay imagen, muestra el icono por defecto -->
                        <div class="flex items-center justify-center h-full">
                            <i class=""></i>
                        </div>
                    </div>
                    <div class="p-6">
                        <h3 class="text-2xl font-black text-gray-800 mb-2">BINGO TRADICIONAL 75</h3>
                        <p class="text-sm text-gray-600 mb-4">¬°Nuestra sala principal con los mayores premios! Reservas tu tabla aqu√≠ en la p√°gina y juegas en WhatsApp.</p>
                        <p class="text-2xl font-black text-yellow-600">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</p>
                        <div class="bg-gradient-to-r from-purple-50 to-emerald-50 rounded-xl p-4 mb-4">
                            <p class="text-xs text-gray-600 font-bold mb-1">ABIERTO: 8:00 AM - CERRADO: 9:00 PM</p>
                            <p class="bote-amount">Bs. 300</p>
                        </div>
                        <a onclick="showCardSelectionModal()" target="_blank" 
                        class="w-full btn-premium2 flex justify-center items-center mb-3"> 
                        COMPRAR TABLASüé´
                        </a>
                        <a href="https://chat.whatsapp.com/EGGD8r6dpU3692oiXlsKAG" target="_blank" 
                        class="w-full btn-premium flex justify-center items-center">
                       JUGAR AHORA
                       </a>
                      </div>
                </div>

                <!-- ========== SALA 2: OMEGA EXPRESS ========== -->
                <!-- EDITA LA IMAGEN DE FONDO AQU√ç -->
                <div class="sala-card">
                    <div class="sala-badge">‚ö° R√ÅPIDO</div>
                    <!-- CAMBIA "sala-omega-express.png" POR TU IMAGEN -->
                    <div class="sala-image-container" style="background-image: url('banersalalineasomega.png')">
                        <!-- Si no hay imagen, muestra el icono por defecto -->
                        <div class="flex items-center justify-center h-full">
                            <i class=""></i>
                        </div>
                    </div>
                    <div class="p-6">
                        <h3 class="text-2xl font-black text-gray-800 mb-2">OMEGA LINEAS</h3>
                        <p class="text-sm text-gray-600 mb-4">¬°Reserva tus n√∫meros para las l√≠neas picante, com√∫n, fuego y drag√≥n! Selecciona, paga y juega.</p>
                        <p class="text-2xl font-black text-yellow-600">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</p>
                        <div class="bg-gradient-to-r from-purple-50 to-emerald-50 rounded-xl p-4 mb-4">
                            <p class="text-xs text-gray-600 font-bold mb-1">ABIERTO: 24/7</p>
                            <p class="text-2xl font-black text-green-600">Bs.50 - Bs.100 - Bs.150 Bs.300</p>
                        </div>
                        <button onclick="openLineReservationModal()" class="w-full btn-premium2 flex justify-center items-center mb-3">
                        RESERVAR L√çNEAS üéØ
                        </button>
                        <a href="https://chat.whatsapp.com/CIL8NiFHcbvAQwEw9Xwfiq" target="_blank" class="w-full btn-premium flex justify-center items-center">
                        JUGAR AHORA
                        </a>
                    </div>
                </div>

                <!-- ========== SALA 3: OMEGA ECON√ìMICA ========== -->
                <!-- EDITA LA IMAGEN DE FONDO AQU√ç -->
                <div class="sala-card">
                    <div class="sala-badge">üåü PREMIUM</div>
                    <!-- CAMBIA "sala-omega-economica.png" POR TU IMAGEN -->
                    <div class="sala-image-container" style="background-image: url('banersalalineaspremium.png')">
                        <!-- Si no hay imagen, muestra el icono por defecto -->
                        <div class="flex items-center justify-center h-full">
                            <i class=""></i>
                        </div>
                    </div>
                    <div class="p-6">
                        <h3 class="text-2xl font-black text-gray-800 mb-2">OMEGA LINEAS PREMIUM</h3>
                        <p class="text-sm text-gray-600 mb-4">¬°Bingo de lineas para los mejores! Reservas y juegas en el grupo de WhatsApp.</p>
                        <p class="text-2xl font-black text-yellow-600">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</p>
                        <div class="bg-gradient-to-r from-purple-50 to-emerald-50 rounded-xl p-4 mb-4">
                            <p class="text-xs text-gray-600 font-bold mb-1">ABIERTO: 9:00 AM - CERRADO: 7:00 PM</p>
                            <p class="text-2xl font-black text-green-600">Bs.500</p>
                        </div>
                        <a href="https://chat.whatsapp.com/LBKPjER51z89VQC5cCRPoU" target="_blank" class="w-full btn-premium flex justify-center items-center">
                        JUGAR AHORA
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <!-- ============================================ -->
        <!-- CARRUSEL DE PUBLICIDAD ADICIONAL -->
        <!-- EDITA AQU√ç LAS IM√ÅGENES Y LINKS DE PUBLICIDAD -->
        <!-- ============================================ -->
        <section class="publicity-carousel-section">
            <div class="max-w-7xl mx-auto px-4 mb-6">
                <h2 class="text-3xl font-black text-gray-800 text-center">¬øQUE HAY DE NUEVO?</h2>
                <p class="text-center text-gray-600 mt-2">Descubre que se esconde aqui üéÅ</p>
            </div>
            
            <div class="publicity-carousel">
                <div class="publicity-item" style="background-image: url('./publicidad/publicidad1.jpg')" onclick="window.open('https://whatsapp.com/channel/0029VbB3UK10VycLExLXJl2e', '_blank')"></div>
                <div class="publicity-item" style="background-image: url('./publicidad/publicidad2.jpg')" onclick="window.open('https://wa.me/p/25140170875649915/584226431972', '_blank')"></div>
                <div class="publicity-item" style="background-image: url('./publicidad/publicidad3.jpg')" onclick="window.open('https://wa.me/584226431972', '_blank')"></div>
                <div class="publicity-item" style="background-image: url('./publicidad/publicidad4.jpg')" onclick="window.open('https://www.facebook.com/profile.php?id=61558597798025', '_blank')"></div>
                <div class="publicity-item" style="background-image: url('./publicidad/publicidad1.jpg')" onclick="window.open('https://whatsapp.com/channel/0029VbB3UK10VycLExLXJl2e', '_blank')"></div>
                <div class="publicity-item" style="background-image: url('./publicidad/publicidad2.jpg')" onclick="window.open('https://wa.me/p/25140170875649915/584226431972', '_blank')"></div>
                <div class="publicity-item" style="background-image: url('./publicidad/publicidad3.jpg')" onclick="window.open('https://wa.me/584226431972', '_blank')"></div>
                <div class="publicity-item" style="background-image: url('./publicidad/publicidad4.jpg')" onclick="window.open('https://www.facebook.com/profile.php?id=61558597798025', '_blank')"></div>
            </div>
        </section>

        <!-- INFORMACI√ìN DE PAGO -->
        <section class="max-w-4xl mx-auto px-4 py-8">
            <div class="bg-white/10 backdrop-blur-md p-6 rounded-2xl shadow-2xl border border-white/20">
                <h3 class="font-bold text-white text-xl mb-4 flex items-center">
                    <svg class="w-6 h-6 mr-3 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path></svg>
                    Datos para Pago M√≥vil
                </h3>
                <div class="grid md:grid-cols-3 gap-4">
                    <div class="bg-white/5 p-4 rounded-xl border border-white/10">
                        <p class="text-gray-300 text-sm mb-1">Banco:</p>
                        <p class="text-white font-bold text-lg cursor-pointer hover:text-yellow-300" onclick="copyToClipboard('0108')">0108 Provincial üìã</p>
                    </div>
                    <div class="bg-white/5 p-4 rounded-xl border border-white/10">
                        <p class="text-gray-300 text-sm mb-1">C√©dula:</p>
                        <p class="text-white font-bold text-lg cursor-pointer hover:text-yellow-300" onclick="copyToClipboard('25822059')">V25822059 üìã</p>
                    </div>
                    <div class="bg-white/5 p-4 rounded-xl border border-white/10">
                        <p class="text-gray-300 text-sm mb-1">Tel√©fono:</p>
                        <p class="text-white font-bold text-lg cursor-pointer hover:text-yellow-300" onclick="copyToClipboard('04129546751')">04129546751 üìã</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECCI√ìN CONSULTAR -->
        <section id="consultar" class="max-w-4xl mx-auto px-4 py-12">
    <div class="text-center mb-8">
        <h2 class="text-3xl font-black text-white mb-2">CONSULTA TUS TABLAS</h2>
        <p class="text-gray-300">Verifica el estado de tus reservas</p>
    </div>

    <div class="grid md:grid-cols-2 gap-6">
        <div class="bg-white p-6 rounded-xl shadow-lg">
            <h3 class="font-bold text-gray-700 mb-4 flex items-center">
                <i class="fas fa-phone mr-2 text-purple-600"></i>
                Consultar por Tel√©fono
            </h3>
            <div class="space-y-4"> 
                <input type="tel" id="searchPhoneInput" placeholder="Ej: 0412..." class="w-full p-3 border-2 border-gray-200 rounded-lg focus:border-purple-500 outline-none">
                
                <button onclick="searchCardByPhone()" class="w-full bg-purple-600 text-white p-3 rounded-lg font-bold hover:bg-purple-700 transition">
                    Buscar
                </button>
            </div>
        </div>

        <div class="bg-white p-6 rounded-xl shadow-lg">
            <h3 class="font-bold text-gray-700 mb-4 flex items-center">
                <i class="fas fa-hashtag mr-2 text-purple-600"></i>
                Ver Tabla Individual
            </h3>
            <div class="space-y-4">
                <input type="number" id="cardNumberInput" placeholder="N¬∞ Tabla" class="w-full p-3 border-2 border-gray-200 rounded-lg focus:border-purple-500 outline-none">
                
                <button onclick="searchCard()" class="w-full bg-purple-600 text-white p-3 rounded-lg font-bold hover:bg-purple-700 transition">
                    Ver
                </button>
            </div>
        </div>
    </div>

    <div id="searchResultArea" class="hidden mt-8 bg-white p-6 rounded-2xl shadow-2xl text-center border-2 border-purple-100">
        <h3 id="resultTitle" class="font-bold text-xl text-purple-800 mb-4"></h3>
        <div id="resultContent" class="flex justify-center flex-wrap gap-4"></div>
        <p id="resultStatus" class="text-sm font-bold"></p>
    </div>
</section>
        <!-- FOOTER PROFESIONAL -->
        <footer id="contacto" class="main-footer">
            <div class="max-w-7xl mx-auto px-4">
                <div class="grid md:grid-cols-3 gap-8 mb-8">
                    <div>
                        <img src="logo-omega-bingo.png" alt="OMEGA" class="h-16 w-16 rounded-full bg-white p-1 mb-4">
                        <h3 class="text-xl font-bold text-yellow-400 mb-2">OMEGA BINGO</h3>
                        <p class="text-gray-400 text-sm">¬°Juega responsable, juega en Familia!</p>
                    </div>
                    
                    <div>
                        <h4 class="text-lg font-bold text-white mb-4">S√çGUENOS</h4>
                        <div class="flex space-x-4">
                            <a href="https://wa.me/584226431972" target="_blank" class="text-3xl hover:scale-110 transition-transform">
                                <i class="fab fa-whatsapp" style="color:#25D366;"></i>
                            </a>
                            <a href="https://www.facebook.com/OmegabingoAA/" target="_blank" class="text-3xl hover:scale-110 transition-transform">
                                <i class="fab fa-facebook" style="color:#3b5998;"></i>
                            </a>
                            <a href="https://www.instagram.com/omega_bingo?igsh=MTY4czZ0NDltZ2gxZA==" target="_blank" class="text-3xl hover:scale-110 transition-transform">
                                <i class="fab fa-instagram" style="color:#E1306C;"></i>
                            </a>
                        </div>
                    </div>

                    <div>
                        <h4 class="text-lg font-bold text-white mb-4">LEGAL</h4>
                        <div class="space-y-2">
                            <button onclick="showLegalModal('terms')" class="block text-gray-300 hover:text-yellow-400 transition">T√©rminos y Condiciones</button>
                            <button onclick="showLegalModal('privacy')" class="block text-gray-300 hover:text-yellow-400 transition">Pol√≠tica de Privacidad</button>
                        </div>
                    </div>
                </div>

                <div class="border-t border-gray-700 pt-6 text-center">
                    <p class="text-gray-400 text-sm mb-2">¬© OMEGA Bingo - Masson 2025 Todos los derechos reservados</p>
                    <img src="logo-masson-bingo.png" alt="Masson" class="h-8 inline-block opacity-50">
                </div>
            </div>
        </footer>
    </div>

    <!-- MODALES -->
    
    <!-- Modal Selecci√≥n de Tablas -->
    <div id="cardSelectionModal" class="modal">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-4 border-b pb-2">
                <h3 class="text-xl font-bold text-gray-800">Selecciona tus Tablas</h3>
                <button onclick="hideCardSelectionModal()" class="text-2xl text-gray-500">&times;</button>
            </div>
            
            <div class="flex justify-between text-[10px] font-bold text-gray-500 mb-4 px-2">
                <span class="flex items-center"><div class="w-3 h-3 bg-purple-700 rounded-full mr-1"></div> Libre</span>
                <span class="flex items-center"><div class="w-3 h-3 bg-yellow-400 rounded-full mr-1"></div> Tuya</span>
                <span class="flex items-center"><div class="w-3 h-3 bg-orange-500 rounded-full mr-1"></div> Ocupada</span>
                <span class="flex items-center"><div class="w-3 h-3 bg-green-600 rounded-full mr-1"></div> Vendida</span>
            </div>

            <div id="cardListContainer" class="grid grid-cols-6 sm:grid-cols-8 gap-2 max-h-[60vh] overflow-y-auto p-1"></div>

            <div class="mt-4 border-t pt-4">
                <div class="flex justify-between items-center mb-3">
                    <span class="text-gray-600 font-bold">Total a Pagar:</span>
                    <span id="totalCostDisplay" class="text-2xl font-black text-green-600">Bs. 0,00</span>
                </div>
                <button onclick="preparePayment()" class="w-full py-3 bg-purple-600 text-white font-bold rounded-lg shadow-lg hover:bg-purple-700 transition">
                    CONTINUAR A PAGO
                </button>
            </div>
        </div>
    </div>

    <!-- Modal Preview de Tabla -->
    <div id="cardPreviewModal" class="modal">
        <div class="modal-content text-center">
            <h3 class="text-xl font-bold text-gray-800 mb-2">Tabla N¬∞ <span id="previewNum" class="text-purple-600"></span></h3>
            <div id="previewImgContainer" class="flex justify-center mb-4 p-2 bg-gray-100 rounded-lg"></div>
            <p id="previewStatusText" class="font-bold mb-4"></p>
            <div class="flex gap-3 justify-center">
                <button id="btnPreviewAction" class="flex-1 py-2 bg-green-500 text-white font-bold rounded-lg shadow">LO QUIERO</button>
                <button onclick="closePreview()" class="flex-1 py-2 bg-gray-300 text-gray-700 font-bold rounded-lg">Cerrar</button>
            </div>
        </div>
    </div>

    <!-- Modal Proceso de Pago -->
    <div id="paymentProcessModal" class="modal">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-2">
                <h3 class="text-lg font-bold text-purple-800">Confirmar Pago</h3>
                <button onclick="hidePaymentModal()" class="text-2xl">&times;</button>
            </div>
            
            <div class="bg-yellow-50 text-yellow-800 p-2 rounded text-center text-sm font-bold mb-4 border border-yellow-200">
                ‚è≥ Tienes <span id="paymentTimer" class="text-red-600 text-lg">05:00</span> para enviar el capture
            <p class="class="text-red-600 text-lg">Pago movil: 25822059 / 04129546751 / 0108-Provincial</li>
            </div>

            <div class="space-y-3 mb-4">
                <div class="flex justify-between text-sm border-b border-dashed pb-1">
                    <span>Tablas:</span> <span id="payCardsList" class="font-bold text-purple-700"></span>
                </div>
                <div class="flex justify-between text-sm border-b border-dashed pb-1">
                    <span>Total:</span> <span id="payTotal" class="font-bold text-green-600 text-lg"></span>
                </div>
            </div>

            <form id="paymentForm" onsubmit="event.preventDefault(); submitPayment();" class="space-y-3">
                <input type="text" id="payName" placeholder="Nombre y Apellido" class="w-full p-3 border rounded bg-gray-50" required>
                <input type="tel" id="payPhone" placeholder="Tel√©fono (WhatsApp)" class="w-full p-3 border rounded bg-gray-50" required>
                <input type="number" id="payRef" placeholder="√öltimos 4 d√≠gitos Referencia" class="w-full p-3 border rounded bg-gray-50" required>
                
                <div class="border-2 border-dashed border-purple-300 rounded-lg p-4 text-center bg-purple-50 cursor-pointer relative">
                    <input type="file" id="payFile" accept="image/*" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer" required>
                    <p class="text-purple-600 font-bold text-sm">üì∏ Toca aqu√≠ para subir CAPTURE</p>
                    <p id="fileNameDisplay" class="text-xs text-gray-500 mt-1"></p>
                </div>

                <button type="submit" class="w-full py-3 bg-green-600 text-white font-bold rounded-lg shadow-lg hover:bg-green-700 transition">
                    ENVIAR COMPROBANTE üöÄ
                </button>
            </form>
            <p id="uploadStatus" class="text-center text-sm mt-2 font-bold hidden"></p>
        </div>
    </div>

    <!-- Modal Legal -->
    <div id="legalModal" class="modal">
        <div class="modal-legal-content">
            <div class="flex justify-between items-center mb-4 border-b pb-2">
                <h3 id="legalModalTitle" class="text-xl font-bold text-gray-800"></h3>
                <button onclick="hideLegalModal()" class="text-2xl text-gray-500">&times;</button>
            </div>
            <div id="legalModalBody" class="modal-legal-body text-sm text-gray-700"></div>
        </div>
    </div>

<!-- Modal Reserva de L√≠neas -->
<div id="lineReservationModal" class="modal">
    <div class="modal-content" style="max-width: 800px;">
        <div class="flex justify-between items-center mb-4 border-b pb-2">
            <h3 class="text-xl font-bold text-gray-800">Reserva de L√≠neas</h3>
            <button onclick="hideLineReservationModal()" class="text-2xl text-gray-500">&times;</button>
        </div>

        <!-- Tabs para las 4 listas -->
        <div class="mb-4">
            <div class="flex border-b">
                <button class="tab-line py-2 px-4 font-bold border-b-2 border-transparent text-gray-500 hover:text-purple-700" data-tab="picante" onclick="switchLineTab('picante')">üå∂Ô∏è Picante</button>
                <button class="tab-line py-2 px-4 font-bold border-b-2 border-transparent text-gray-500 hover:text-purple-700" data-tab="comun" onclick="switchLineTab('comun')">‚≠ê Com√∫n</button>
                <button class="tab-line py-2 px-4 font-bold border-b-2 border-transparent text-gray-500 hover:text-purple-700" data-tab="fuego" onclick="switchLineTab('fuego')">üî• Fuego</button>
                <button class="tab-line py-2 px-4 font-bold border-b-2 border-transparent text-gray-500 hover:text-purple-700" data-tab="dragon" onclick="switchLineTab('dragon')">üêâ Drag√≥n</button>
            </div>
        </div>

        <!-- Contenido de cada lista -->
        <div id="tab-content-picante" class="tab-content-line">
            <div class="text-center mb-4">
                <h4 class="text-lg font-bold text-gray-800">üå∂Ô∏è L√≠nea Picante</h4>
                <p class="text-sm text-gray-600">Premios: üèÜ1¬∞: 500 üèÜ2¬∞: 250 üèÜ3¬∞: 200 üèÜ4¬∞: 150 üèÜ5¬∞: 100 üèÜ6¬∞: 100 / Precio: 100</p>
            </div>
            <div class="grid grid-cols-5 gap-4" id="line-numbers-picante"></div>
        </div>

        <div id="tab-content-comun" class="tab-content-line hidden">
            <div class="text-center mb-4">
                <h4 class="text-lg font-bold text-gray-800">‚≠ê L√≠nea Com√∫n</h4>
                <p class="text-sm text-gray-600">Premios: üèÜ1¬∞: 300 üèÜ2¬∞: 150 üèÜ3¬∞: 100 üèÜ4¬∞: 100 / Precio: 50</p>
            </div>
            <div class="grid grid-cols-5 gap-4" id="line-numbers-comun"></div>
        </div>

        <div id="tab-content-fuego" class="tab-content-line hidden">
            <div class="text-center mb-4">
                <h4 class="text-lg font-bold text-gray-800">üî• L√≠nea de Fuego</h4>
                <p class="text-sm text-gray-600">Premios: üèÜ1¬∞: 500 üèÜ2¬∞: 500 üèÜ3¬∞: 300 üèÜ4¬∞: 250 üèÜ5¬∞: 250 üèÜ6¬∞: 250 / Precio: 150</p>
            </div>
            <div class="grid grid-cols-5 gap-4" id="line-numbers-fuego"></div>
        </div>

        <div id="tab-content-dragon" class="tab-content-line hidden">
            <div class="text-center mb-4">
                <h4 class="text-lg font-bold text-gray-800">üêâ L√≠nea Drag√≥n</h4>
                <p class="text-sm text-gray-600">Premios: üèÜ1¬∞: 1,000 üèÜ2¬∞: 700 üèÜ3¬∞: 500 üèÜ4¬∞: 500 üèÜ5¬∞: 500 üèÜ6¬∞: 500 üèÜ7¬∞: 500 / Precio: 300</p>
            </div>
            <div class="grid grid-cols-5 gap-4" id="line-numbers-dragon"></div>
        </div>

        <!-- Informaci√≥n de selecci√≥n -->
        <div class="mt-6 border-t pt-4">
            <div class="flex justify-between items-center mb-2">
                <span class="text-gray-600 font-bold">Lista seleccionada:</span>
                <span id="current-line-name" class="font-bold text-purple-700">üå∂Ô∏è Picante</span>
            </div>
            <div class="flex justify-between items-center mb-2">
                <span class="text-gray-600 font-bold">N√∫meros seleccionados:</span>
                <span id="selected-line-numbers" class="font-bold text-green-600">Ninguno</span>
            </div>
            <div class="flex justify-between items-center mb-4">
                <span class="text-gray-600 font-bold">Total a pagar:</span>
                <span id="line-total-cost" class="text-2xl font-black text-green-600">Bs. 0,00</span>
            </div>

            <button id="btn-reserve-lines" onclick="reserveSelectedLines()" class="w-full py-3 bg-purple-600 text-white font-bold rounded-lg shadow-lg hover:bg-purple-700 transition">
                RESERVAR L√çNEAS SELECCIONADAS
            </button>
        </div>
    </div>
</div>

<!-- Modal Pago de L√≠neas -->
<div id="linePaymentModal" class="modal">
    <div class="modal-content">
        <div class="flex justify-between items-center mb-2">
            <h3 class="text-lg font-bold text-purple-800">Confirmar Pago de L√≠neas</h3>
            <button onclick="hideLinePaymentModal()" class="text-2xl">&times;</button>
        </div>
        
        <div class="bg-yellow-50 text-yellow-800 p-2 rounded text-center text-sm font-bold mb-4 border border-yellow-200">
            ‚è≥ Tienes <span id="linePaymentTimer" class="text-red-600 text-lg">10:00</span> para enviar el capture
       <p class="class="text-red-600 text-lg">Pago movil: 25822059 / 04129546751 / 0108-Provincial</li>
        </div>

        <div class="space-y-3 mb-4">
            <div class="flex justify-between text-sm border-b border-dashed pb-1">
                <span>Lista:</span> <span id="payLineList" class="font-bold text-purple-700"></span>
            </div>
            <div class="flex justify-between text-sm border-b border-dashed pb-1">
                <span>N√∫meros:</span> <span id="payLineNumbers" class="font-bold text-green-600"></span>
            </div>
            <div class="flex justify-between text-sm border-b border-dashed pb-1">
                <span>Total:</span> <span id="payLineTotal" class="font-bold text-green-600 text-lg"></span>
            </div>
        </div>

        <form id="linePaymentForm" onsubmit="event.preventDefault(); submitLinePayment();" class="space-y-3">
            <input type="text" id="linePayName" placeholder="Nombre y Apellido" class="w-full p-3 border rounded bg-gray-50" required>
            <input type="tel" id="linePayPhone" placeholder="Tel√©fono (WhatsApp)" class="w-full p-3 border rounded bg-gray-50" required>
            <input type="number" id="linePayRef" placeholder="√öltimos 4 d√≠gitos Referencia" class="w-full p-3 border rounded bg-gray-50" required>
            
            <div class="border-2 border-dashed border-purple-300 rounded-lg p-4 text-center bg-purple-50 cursor-pointer relative">
                <input type="file" id="linePayFile" accept="image/*" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer" required>
                <p class="text-purple-600 font-bold text-sm">üì∏ Toca aqu√≠ para subir CAPTURE</p>
                <p id="lineFileNameDisplay" class="text-xs text-gray-500 mt-1"></p>
            </div>

            <button type="submit" class="w-full py-3 bg-green-600 text-white font-bold rounded-lg shadow-lg hover:bg-green-700 transition">
                ENVIAR COMPROBANTE üöÄ
            </button>
        </form>
        <p id="lineUploadStatus" class="text-center text-sm mt-2 font-bold hidden"></p>
    </div>
</div>
    
    <script>
        
        // ============================================
        // CONFIGURACI√ìN
        // ============================================
        const TOTAL_CARDS = 75;
        const CARD_PRICE = 300;
        const BINGO_DATE_STRING = 'December 23, 2025 20:00:00';
        const BINGO_DATE = new Date(BINGO_DATE_STRING).getTime();
        
        let selectedCards = JSON.parse(localStorage.getItem('omega_selected_cards')) || [];
        let liveData = {};
        let previewCard = null;
        let timerInterval;
        let adminClicks = 0;
        let isStoreOpen = true;
        let currentSala = 'OMEGA_MAYOR';

// ============================================
// VARIABLES PARA RESERVA DE L√çNEAS
// ============================================
let currentLineTab = 'picante';
let selectedLineNumbers = {
    picante: [],
    comun: [],
    fuego: [],
    dragon: []
};
let lineData = {};
let linePaymentTimerInterval;
let linePrices = {
    picante: 100,
    comun: 50,
    fuego: 150,
    dragon: 300
};
let lineNames = {
    picante: 'üå∂Ô∏è L√≠nea Picante',
    comun: '‚≠ê L√≠nea Com√∫n',
    fuego: 'üî• L√≠nea de Fuego',
    dragon: 'üêâ L√≠nea Drag√≥n'
};
let currentLineReservation = null;
        
        // ============================================
        // CARRUSEL HERO - FUNCIONES
        // ============================================
        let currentSlide = 0;
        let autoSlideInterval;
        const slides = document.querySelectorAll('.hero-slide');
        const totalSlides = slides.length;

        function updateCarousel() {
            const carousel = document.getElementById('heroCarousel');
            carousel.style.transform = `translateX(-${currentSlide * 100}%)`;
            
            // Actualizar dots
            const dots = document.querySelectorAll('.carousel-dot');
            dots.forEach((dot, index) => {
                dot.classList.toggle('active', index === currentSlide);
            });
        }

        function moveCarousel(direction) {
            currentSlide += direction;
            if (currentSlide < 0) currentSlide = totalSlides - 1;
            if (currentSlide >= totalSlides) currentSlide = 0;
            updateCarousel();
            resetAutoSlide();
        }

        function goToSlide(index) {
            currentSlide = index;
            updateCarousel();
            resetAutoSlide();
        }

        function autoSlide() {
            currentSlide++;
            if (currentSlide >= totalSlides) currentSlide = 0;
            updateCarousel();
        }

        function resetAutoSlide() {
            clearInterval(autoSlideInterval);
            autoSlideInterval = setInterval(autoSlide, 5000); // Cambia cada 5 segundos
        }

        function initCarousel() {
            const dotsContainer = document.getElementById('carouselDots');
            for (let i = 0; i < totalSlides; i++) {
                const dot = document.createElement('div');
                dot.className = 'carousel-dot';
                if (i === 0) dot.classList.add('active');
                dot.onclick = () => goToSlide(i);
                dotsContainer.appendChild(dot);
            }
            resetAutoSlide();
        }

        // ========== JUEGO DINO ==========
        const canvas = document.getElementById('dinoCanvas');
        const ctx = canvas.getContext('2d');
        let gameAnimationFrame, gameScore = 0, gameSpeed = 5, isGaming = false;
        
        canvas.width = 600;
        canvas.height = 200;

        let dino = { x: 50, y: 150, width: 30, height: 30, dy: 0, jumpPower: -15, gravity: 0.8, grounded: true };
        let obstacles = [];
        let frameCount = 0;

        function drawPixelDino(x, y) {
            ctx.fillStyle = 'black';
            ctx.fillRect(x, y, 30, 30);
            ctx.fillRect(x + 10, y - 10, 20, 20);
            ctx.fillStyle = 'white';
            ctx.fillRect(x + 20, y - 5, 5, 5);
        }

        function drawCactus(x, y, w, h) {
            ctx.fillStyle = '#9333ea';
            ctx.fillRect(x, y, w, h);
            ctx.fillStyle = '#7e22ce';
            ctx.fillRect(x+5, y+5, w-10, h-10);
        }

        function drawBird(x, y) {
            ctx.fillStyle = '#4b5563';
            ctx.beginPath();
            ctx.moveTo(x, y);
            ctx.lineTo(x+15, y+10);
            ctx.lineTo(x+30, y);
            ctx.lineTo(x+15, y-5);
            ctx.fill();
        }

        function spawnObstacle() {
            let type = Math.random() > 0.7 ? 'bird' : 'cactus';
            let obj = { x: canvas.width, type: type, passed: false };
            if(type === 'cactus') {
                obj.y = 150;
                obj.width = 20 + Math.random() * 20;
                obj.height = 30 + Math.random() * 20;
            } else {
                obj.y = 90 + Math.random() * 40;
                obj.width = 30;
                obj.height = 20;
            }
            obstacles.push(obj);
        }

        function updateGame() {
            if(!isGaming) return;
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.beginPath();
            ctx.moveTo(0, 180);
            ctx.lineTo(canvas.width, 180);
            ctx.strokeStyle = '#ddd';
            ctx.stroke();

            dino.dy += dino.gravity;
            dino.y += dino.dy;

            if (dino.y > 150) {
                dino.y = 150;
                dino.dy = 0;
                dino.grounded = true;
            } else {
                dino.grounded = false;
            }

            drawPixelDino(dino.x, dino.y);

            frameCount++;
            if (frameCount % (100 - Math.floor(gameSpeed * 2)) === 0) {
                spawnObstacle();
            }

            for (let i = 0; i < obstacles.length; i++) {
                let obs = obstacles[i];
                obs.x -= gameSpeed;

                if (obs.type === 'cactus') drawCactus(obs.x, obs.y, obs.width, obs.height);
                else drawBird(obs.x, obs.y);

                if (dino.x < obs.x + obs.width && dino.x + dino.width > obs.x && dino.y < obs.y + obs.height && dino.y + dino.height > obs.y) {
                    gameOver();
                }

                if (obs.x + obs.width < dino.x && !obs.passed) {
                    gameScore += 10;
                    obs.passed = true;
                    document.getElementById('gameScore').innerText = gameScore;
                    if(gameScore % 100 === 0) gameSpeed += 0.5;
                }
            }
            
            obstacles = obstacles.filter(obs => obs.x > -50);
            gameAnimationFrame = requestAnimationFrame(updateGame);
        }

        function jumpDino() {
            if (!isGaming) return;
            if (dino.grounded) {
                dino.dy = dino.jumpPower;
                dino.grounded = false;
            }
        }

        document.addEventListener('keydown', function(event) {
            if (event.code === 'Space' && isGaming) jumpDino();
        });

        function startGame() {
            document.getElementById('gameMessage').classList.add('hidden');
            gameScore = 0;
            gameSpeed = 5;
            obstacles = [];
            dino.y = 150;
            dino.dy = 0;
            isGaming = true;
            document.getElementById('gameScore').innerText = "0";
            updateGame();
        }

        function gameOver() {
            isGaming = false;
            cancelAnimationFrame(gameAnimationFrame);
            document.getElementById('msgTitle').innerText = "GAME OVER";
            document.getElementById('msgTitle').classList.add('text-red-600');
            document.querySelector('#gameMessage button').innerText = "INTENTAR DE NUEVO ‚Ü∫";
            document.getElementById('gameMessage').classList.remove('hidden');
        }

        function stopGameLogic() {
            isGaming = false;
            cancelAnimationFrame(gameAnimationFrame);
        }

        // ========== INICIALIZACI√ìN (MODIFICADO) ==========
window.onload = () => {
    document.getElementById('bingoDateDisplay').textContent = new Date(BINGO_DATE).toLocaleDateString('es-ES', { 
        weekday: 'long', year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit' 
    });

    // Inicializar carrusel
    initCarousel();
    
    // --- NUEVO: AGREGAR SOPORTE PARA DESLIZAR (SWIPE) ---
    setupCarouselTouch(); 

    startRealtimeSync();
    startBingoTimer();
    checkStoreStatus();
    
    const pendingTimer = localStorage.getItem('omega_payment_start');
    if (pendingTimer && selectedCards.length > 0) startPaymentTimer();

    document.getElementById('payFile').addEventListener('change', function(e) {
        if(this.files[0]) document.getElementById('fileNameDisplay').textContent = this.files[0].name;
    });

    // --- NUEVO: REINICIAR TIMER SI LA PESTA√ëA SE VUELVE A ABRIR ---
    document.addEventListener("visibilitychange", () => {
        if (!document.hidden) {
            resetAutoSlide(); // Reactiva el carrusel si el usuario vuelve a la pesta√±a
        }
    });
};

// --- NUEVA FUNCI√ìN PARA DETECTAR EL DEDO ---
function setupCarouselTouch() {
    const container = document.getElementById('heroCarousel');
    let touchStartX = 0;
    let touchEndX = 0;

    // Cuando el dedo toca la pantalla
    container.addEventListener('touchstart', (e) => {
        touchStartX = e.changedTouches[0].screenX;
        clearInterval(autoSlideInterval); // Pausar autom√°tico mientras el usuario toca
    }, {passive: true});

    // Cuando el dedo se levanta de la pantalla
    container.addEventListener('touchend', (e) => {
        touchEndX = e.changedTouches[0].screenX;
        handleGesture();
        resetAutoSlide(); // Reiniciar autom√°tico al soltar
    }, {passive: true});

    function handleGesture() {
        // Detectar si fue un deslizamiento fuerte (m√°s de 50px)
        if (touchEndX < touchStartX - 50) {
            moveCarousel(1); // Deslizar a la izquierda -> Siguiente
        }
        if (touchEndX > touchStartX + 50) {
            moveCarousel(-1); // Deslizar a la derecha -> Anterior
        }
    }
}

        // Inicializar sistema de l√≠neas
setupLineEventListeners();
startLineReservationSync();

// Verificar temporizador de pago de l√≠neas
const linePaymentTimer = localStorage.getItem('omega_line_payment_start');
if (linePaymentTimer) {
    startLinePaymentTimer();
}

// Funci√≥n para configurar event listeners de l√≠neas
function setupLineEventListeners() {
    document.getElementById('linePayFile').addEventListener('change', function(e) {
        if (this.files[0]) {
            document.getElementById('lineFileNameDisplay').textContent = this.files[0].name;
        }
    });
}

// Funci√≥n para iniciar sincronizaci√≥n en tiempo real de l√≠neas
function startLineReservationSync() {
    // Esto ya est√° incluido en loadLineData()
}

                // ==========================================
        // NUEVA L√ìGICA DE MANTENIMIENTO Y VISIBILIDAD
        // ==========================================

        function updateStoreUI() {
            const overlay = document.getElementById('closedStoreOverlay');
            const currentUser = auth.currentUser; // Verificamos si es Admin
            
            // Elementos del Panel de Admin
            const btn = document.getElementById('toggleStoreBtn');
            const statusText = document.getElementById('storeStatusText');

            // Elementos del Overlay (para cambiar texto)
            const overlayTitle = document.getElementById('overlayTitle');
            const overlaySubtitle = document.getElementById('overlaySubtitle');

            // 1. CONFIGURACI√ìN DEL PANEL DE ADMIN (Botones y Textos)
            if(btn && statusText) {
                if(isStoreOpen) {
                    // TIENDA ABIERTA
                    btn.textContent = "ACTIVAR MANTENIMIENTO üîí";
                    btn.className = "px-6 py-3 rounded-lg font-black text-white transition-colors shadow-lg bg-red-600 hover:bg-red-700";
                    statusText.textContent = "‚úÖ La tienda est√° ABIERTA y visible para todos.";
                    statusText.className = "text-sm text-green-600 font-bold mt-1";
                } else {
                    // TIENDA CERRADA / MANTENIMIENTO
                    btn.textContent = "ABRIR TIENDA AL P√öBLICO üîì";
                    btn.className = "px-6 py-3 rounded-lg font-black text-white transition-colors shadow-lg bg-green-600 hover:bg-green-700";
                    statusText.textContent = "‚õî MODO MANTENIMIENTO ACTIVO (Invisible para clientes).";
                    statusText.className = "text-sm text-red-600 font-bold mt-1";
                }
            }

            // 2. L√ìGICA DE VISIBILIDAD (EL CAMBIO CLAVE)
            // Si la tienda est√° CERRADA (isStoreOpen = false)
            if (!isStoreOpen) {
                if (currentUser) {
                    // ERES ADMIN: Te dejamos pasar aunque est√© cerrada
                    overlay.style.display = 'none';
                    document.body.style.overflow = 'auto';
                    stopGameLogic();
                    
                    // Opcional: Mostrar un aviso visual de que est√°s en modo mantenimiento
                    // (Podr√≠as agregar un banner peque√±o si quisieras, pero con ver el panel basta)
                } else {
                    // ERES CLIENTE: Te mostramos el bloqueo y cambiamos el texto a Mantenimiento
                    overlay.style.display = 'flex';
                    document.body.style.overflow = 'hidden';
                    
                    // Cambiamos el texto del bloqueo para indicar Mantenimiento
                    if(overlayTitle) overlayTitle.textContent = "P√ÅGINA EN MANTENIMIENTO";
                    if(overlaySubtitle) overlaySubtitle.textContent = "Estamos mejorando la experiencia. Volvemos pronto.";
                }
            } else {
                // TIENDA ABIERTA: Nadie ve el overlay (excepto si forzaras algo, pero por defecto no)
                overlay.style.display = 'none';
                document.body.style.overflow = 'auto';
                stopGameLogic();
                
                // Restauramos textos por defecto por si se cierra por horario luego
                if(overlayTitle) overlayTitle.textContent = "¬°A√∫n estamos cerrados!";
                if(overlaySubtitle) overlaySubtitle.textContent = "Reservas a partir de las 8:00 AM";
            }
        }

        function toggleStoreStatus() {
            const newState = !isStoreOpen;
            const message = newState 
                ? "¬øABRIR la tienda al p√∫blico? Los clientes podr√°n entrar y comprar." 
                : "¬øACTIVAR MANTENIMIENTO? Los clientes ver√°n la pantalla de bloqueo, pero T√ö podr√°s seguir viendo la p√°gina.";
            
            if(confirm(message)) {
                db.collection('config').doc('general').set({ isStoreOpen: newState }, { merge: true })
                .then(() => {
                    // Feedback visual inmediato
                    alert(newState ? "Tienda ABIERTA" : "Mantenimiento ACTIVADO");
                })
                .catch(err => alert("Error al cambiar estado: " + err.message));
            }
        }

        let lockClicks = 0;
        document.getElementById('adminSecretLock').addEventListener('click', () => {
            lockClicks++;
            if(lockClicks >= 6) {
                document.getElementById('closedStoreOverlay').style.display = 'none';
                stopGameLogic();
                document.getElementById('clientContent').classList.add('hidden');
                document.getElementById('adminPanel').classList.remove('hidden');
                document.getElementById('adminLogin').classList.remove('hidden');
                lockClicks = 0;
            }
        });

        function startRealtimeSync() {
            db.collection('ventasConfirmadas').onSnapshot(snap => {
                snap.docChanges().forEach(change => {
                    const d = change.doc.data();
                    (d.cards || []).forEach(c => {
                        if(change.type === 'removed') delete liveData[c];
                        else liveData[c] = { status: 'sold', ...d };
                    });
                });
                updateUI();
                if(auth.currentUser) renderAdminSoldList();
            });

            db.collection('reservasPendientes').onSnapshot(snap => {
                snap.docChanges().forEach(change => {
                    const d = change.doc.data();
                    const docId = change.doc.id;
                    
                    (d.cards || []).forEach(c => {
                        const isSold = liveData[c]?.status === 'sold';
                        if(change.type === 'removed') {
                            if (!isSold) delete liveData[c];
                        } else {
                            if(!isSold) liveData[c] = { status: 'reserved', reservationId: docId, ...d };
                        }
                    });
                });
                updateUI();
                if(auth.currentUser) renderAdminPendingList();
            });

                        auth.onAuthStateChanged(u => {
    updateStoreUI();
    
    if(u) {
        renderAdminPendingList();
        renderAdminSoldList();
        loadLineStats(); // Nueva funci√≥n para cargar estad√≠sticas
        renderAdminLinePending(); // Nueva funci√≥n para cargar reservas de l√≠neas
    } 
    
    // Si el panel de admin ya est√° visible...
    if (u && document.getElementById('adminPanel').classList.contains('hidden') === false) {
        document.getElementById('adminLogin').classList.add('hidden');
        document.getElementById('adminDashboard').classList.remove('hidden');
    }
});

        }
        
        function updateUI() {
            let sold = 0;
            for(let i=1; i<=TOTAL_CARDS; i++) {
                if(liveData[i]?.status === 'sold') sold++;
            }
            document.getElementById('availableCount').textContent = TOTAL_CARDS - sold;
            
            const selectionModal = document.getElementById('cardSelectionModal');
            if(selectionModal && selectionModal.style.display === 'flex') {
                renderGrid();
            }

            if(document.getElementById('paymentProcessModal').style.display === 'flex') {
                checkPaymentConflicts();
            }
        }

        function checkPaymentConflicts() {
            let conflicts = [];
            let newSelection = [];
            selectedCards.forEach(card => {
                const status = getStatus(card);
                if (status === 'sold' || status === 'reserved') conflicts.push(card);
                else newSelection.push(card);
            });

            if (conflicts.length > 0) {
                alert(`‚ö†Ô∏è ¬°ATENCI√ìN! El n√∫mero(s) ${conflicts.join(', ')} acaba de ser comprado/reservado por otro jugador.`);
                selectedCards = newSelection;
                saveLocalSelection();

                if (selectedCards.length === 0) {
                    hidePaymentModal();
                    localStorage.removeItem('omega_payment_start');
                } else {
                    document.getElementById('payCardsList').textContent = selectedCards.join(', ');
                    document.getElementById('payTotal').textContent = `Bs. ${(selectedCards.length * CARD_PRICE).toFixed(2)}`;
                }
            }
        }

        function selectSala(sala) {
            currentSala = sala;
            alert(`Has seleccionado la sala: ${sala}. ¬°Ahora puedes comprar tus tablas!`);
            showCardSelectionModal();
        }

        function showCardSelectionModal() {
            document.getElementById('cardPreviewModal').style.display = 'none';
            document.getElementById('paymentProcessModal').style.display = 'none';
            document.getElementById('legalModal').style.display = 'none';
            const modal = document.getElementById('cardSelectionModal');
            modal.style.display = 'flex';
            renderGrid();
            updateTotal();
            if(selectedCards.length > 0 && localStorage.getItem('omega_payment_start')) {
                startPaymentTimer();
            } else {
                clearInterval(timerInterval);
            }
        }

        function hideCardSelectionModal() {
            document.getElementById('cardSelectionModal').style.display = 'none';
        }

        function getStatus(n) {
            if(liveData[n]?.status === 'sold') return 'sold';
            if(liveData[n]?.status === 'reserved') return 'reserved';
            if(selectedCards.includes(n)) return 'selected';
            return 'available';
        }

        function renderGrid() {
            const container = document.getElementById('cardListContainer');
            container.innerHTML = '';
            for(let i=1; i<=TOTAL_CARDS; i++) {
                const st = getStatus(i);
                let tag = 'VER';
                if(st === 'sold') tag = 'VENDIDA';
                if(st === 'reserved') tag = 'OCUPADA';
                if(st === 'selected') tag = 'TUYA';

                const div = document.createElement('div');
                div.className = `card-item-container status-${st}`;
                
                div.innerHTML = `
                    <div class="bingo-ball" onclick="handleBallClick(${i}, '${st}')">${i}</div>
                    <span class="ver-tag" onclick="event.stopPropagation(); openPreview(${i})">${tag}</span>
                `;
                container.appendChild(div);
            }
        }
        
        function handleBallClick(n, st) {
            if(st === 'sold' || st === 'reserved') {
                openPreview(n);
            } else {
                if(selectedCards.includes(n)) selectedCards = selectedCards.filter(x => x !== n);
                else {
                    if (liveData[n]?.status === 'sold' || liveData[n]?.status === 'reserved') {
                        openPreview(n);
                        return;
                    }
                    selectedCards.push(n);
                }
                saveLocalSelection();
                updateTotal();
                renderGrid();
            }
        }

        function updateTotal() {
            const tot = selectedCards.length * CARD_PRICE;
            document.getElementById('totalCostDisplay').textContent = `Bs. ${tot.toFixed(2)}`;
        }

        function openPreview(n) {
            previewCard = n;
            const st = getStatus(n);
            const d = liveData[n];
            const btn = document.getElementById('btnPreviewAction');
            const txt = document.getElementById('previewStatusText');
            
            document.getElementById('previewNum').textContent = n;
            document.getElementById('previewImgContainer').innerHTML = `<img src="./tablas/tabla_${n}.png" class="bingo-card-image" onerror="this.src='https://placehold.co/300?text=Tabla+${n}'">`;
            
            if(st === 'sold') {
                txt.textContent = `‚ùå VENDIDA. (${d.name || 'Otro jugador'})`;
                txt.className = "text-red-600 font-bold mb-4";
                btn.style.display = 'none';
            } else if(st === 'reserved') {
                txt.textContent = `‚è≥ OCUPADA. (${d.name || 'Otro jugador'})`;
                txt.className = "text-orange-500 font-bold mb-4";
                btn.style.display = 'none';
            } else {
                const isSel = selectedCards.includes(n);
                txt.textContent = isSel ? "¬øYa no quieres esta tabla?" : "¬øTe gusta esta tabla?";
                txt.className = "text-gray-700 font-bold mb-4";
                btn.style.display = 'block';
                btn.textContent = isSel ? "QUITAR DE MI LISTA" : "AGREGAR A MI LISTA";
                btn.className = isSel ? "flex-1 py-2 bg-red-500 text-white font-bold rounded-lg" : "flex-1 py-2 bg-green-500 text-white font-bold rounded-lg";
                btn.onclick = () => {
                    if(isSel) selectedCards = selectedCards.filter(x => x !== n);
                    else selectedCards.push(n);
                    
                    saveLocalSelection();
                    updateTotal();
                    closePreview();
                    showCardSelectionModal();
                };
            }
            
            document.getElementById('cardSelectionModal').style.display = 'none';
            document.getElementById('cardPreviewModal').style.display = 'flex';
        }

        function closePreview() {
            document.getElementById('cardPreviewModal').style.display = 'none';
            showCardSelectionModal();
        }

        function preparePayment() {
            if(selectedCards.length === 0) return alert("Selecciona al menos una tabla");
            
            const cardsToCheck = [...selectedCards];
            let conflictDuringSelection = false;
            for (const card of cardsToCheck) {
                if (liveData[card] && (liveData[card].status === 'sold' || liveData[card].status === 'reserved')) {
                    selectedCards = selectedCards.filter(x => x !== card);
                    conflictDuringSelection = true;
                }
            }
            if (conflictDuringSelection) {
                saveLocalSelection();
                updateTotal();
                alert("‚ö†Ô∏è Una o m√°s de tus tablas fueron reservadas o vendidas.");
            }

            if (selectedCards.length === 0) {
                hideCardSelectionModal();
                return;
            }
            
            document.getElementById('payName').value = '';
            document.getElementById('payPhone').value = '';
            document.getElementById('payRef').value = '';
            document.getElementById('fileNameDisplay').textContent = '';

            if (!localStorage.getItem('omega_payment_start')) {
                localStorage.setItem('omega_payment_start', Date.now());
            }

            hideCardSelectionModal();
            document.getElementById('paymentProcessModal').style.display = 'flex';
            
            document.getElementById('payCardsList').textContent = selectedCards.join(', ');
            document.getElementById('payTotal').textContent = `Bs. ${(selectedCards.length * CARD_PRICE).toFixed(2)}`;
            
            startPaymentTimer();
        }

        function startPaymentTimer() {
            const display = document.getElementById('paymentTimer');
            clearInterval(timerInterval);
            
            const startTime = parseInt(localStorage.getItem('omega_payment_start'));
            if (!startTime) return;

            timerInterval = setInterval(() => {
                const now = Date.now();
                const elapsedSeconds = Math.floor((now - startTime) / 1000);
                const totalDuration = 300;
                let remaining = totalDuration - elapsedSeconds;

                if (remaining < 0) remaining = 0;

                const m = Math.floor(remaining / 60);
                const s = remaining % 60;
                display.textContent = `0${m}:${s<10?'0'+s:s}`;

                if(remaining <= 0) {
                    clearInterval(timerInterval);
                    alert("Tiempo agotado. Las tablas han sido liberadas.");
                    
                    localStorage.removeItem('omega_payment_start');
                    selectedCards = [];
                    localStorage.removeItem('omega_selected_cards');
                    
                    hidePaymentModal();
                    updateUI();
                }
            }, 1000);
        }

        function hidePaymentModal() {
            document.getElementById('paymentProcessModal').style.display = 'none';
            showCardSelectionModal();
        }

        async function submitPayment() {
            const YOUR_CLOUD_NAME = "dcenrp74j";
            const YOUR_UPLOAD_PRESET = "bingo_comprobantes";
            
            const name = document.getElementById('payName').value;
            const phone = document.getElementById('payPhone').value.replace(/\D/g,'');
            const ref = document.getElementById('payRef').value;
            const file = document.getElementById('payFile').files[0];
            const statusMsg = document.getElementById('uploadStatus');

            if(!name || phone.length < 10 || !ref || !file) {
                statusMsg.textContent = "Datos incompletos.";
                statusMsg.className = "text-center text-sm mt-2 font-bold text-red-600 block";
                return;
            }

            for (const card of selectedCards) {
                if (liveData[card] && liveData[card].status === 'sold') {
                    statusMsg.textContent = `Error: Tabla N¬∞ ${card} fue VENDIDA.`;
                    statusMsg.className = "text-center text-sm mt-2 font-bold text-red-600 block";
                    return;
                }
            }

            statusMsg.textContent = "Subiendo comprobante... ‚è≥";
            statusMsg.className = "text-center text-sm mt-2 font-bold text-blue-600 block";

            try {
                const formData = new FormData();
                formData.append('file', file);
                formData.append('upload_preset', YOUR_UPLOAD_PRESET);
                formData.append('public_id', `${phone}_${Date.now()}`);
                const uploadUrl = `https://api.cloudinary.com/v1_1/${YOUR_CLOUD_NAME}/image/upload`;

                const response = await fetch(uploadUrl, { method: 'POST', body: formData });
                const data = await response.json();
                const url = data.secure_url;
                
                if (!response.ok || !url) throw new Error(data.error ? data.error.message : response.statusText);

                const newDocRef = await db.collection('reservasPendientes').add({
                    name: name,
                    phone: phone,
                    reference: ref,
                    proofURL: url,
                    cards: selectedCards,
                    totalAmount: selectedCards.length * CARD_PRICE,
                    timestamp: Date.now(),
                    status: 'PENDING_CONFIRMATION',
                    sala: currentSala
                });

                selectedCards.forEach(c => {
                    liveData[c] = { status: 'reserved', reservationId: newDocRef.id, name: name, phone: phone };
                });
                
                statusMsg.textContent = "¬°Enviado! üéâ";
                confetti({ particleCount: 100, spread: 70 });
                
                selectedCards = [];
                localStorage.removeItem('omega_selected_cards');
                localStorage.removeItem('omega_payment_start');
                clearInterval(timerInterval);

                setTimeout(() => {
                    hidePaymentModal();
                    alert("Tu pago ha sido enviado. Espera la confirmaci√≥n del administrador.");
                }, 1500);

            } catch(e) {
                console.error("Error al subir:", e);
                statusMsg.textContent = `Error: ${e.message}`;
                statusMsg.className = "text-center text-sm mt-2 font-bold text-red-600 block";
            }
        }

        async function searchCardByPhone() {
            const p = document.getElementById('searchPhoneInput').value.replace(/\D/g,'');
            if(p.length < 10) return alert("Tel√©fono inv√°lido");
            const div = document.getElementById('searchResultArea');
            const content = document.getElementById('resultContent');
            div.classList.remove('hidden');
            content.innerHTML = 'Buscando...';
            
            let found = [];
            const soldSnap = await db.collection('ventasConfirmadas').where('phone', '==', p).get();
            soldSnap.forEach(doc => { doc.data().cards.forEach(c => found.push({n:c, st:'VENDIDA', col:'green'})); });
            const pendSnap = await db.collection('reservasPendientes').where('phone', '==', p).get();
            pendSnap.forEach(doc => { doc.data().cards.forEach(c => found.push({n:c, st:'EN REVISI√ìN', col:'orange'})); });

            content.innerHTML = '';
            if(found.length === 0) content.innerHTML = '<p>No se encontraron tablas asociadas a este tel√©fono.</p>';
            else {
                document.getElementById('resultTitle').textContent = `Jugador: ${p}`;
                const uniqueCards = [...new Set(found.map(f => f.n))].map(n => {
                    const status = found.filter(f => f.n === n).map(f => f.st).includes('VENDIDA') ? 'VENDIDA' : 'EN REVISI√ìN';
                    const col = status === 'VENDIDA' ? 'green' : 'orange';
                    return { n, st: status, col };
                });

                uniqueCards.forEach(f => {
                    content.innerHTML += `<div class="bg-${f.col}-100 border border-${f.col}-500 p-2 rounded"><span class="text-2xl font-black text-${f.col}-700">${f.n}</span><br><span class="text-xs font-bold text-${f.col}-800">${f.st}</span></div>`;
                });
            }
        }

        function searchCard() {
            const n = parseInt(document.getElementById('cardNumberInput').value);
            if(!n) return;
            const div = document.getElementById('searchResultArea');
            const content = document.getElementById('resultContent');
            div.classList.remove('hidden');
            const d = liveData[n];
            const st = d ? (d.status === 'sold' ? 'VENDIDA' : 'RESERVADA') : 'DISPONIBLE';
            const col = d ? (d.status === 'sold' ? 'green' : 'orange') : 'purple';
            document.getElementById('resultTitle').textContent = `Tabla #${n}`;
            content.innerHTML = `<div class="text-center"><img src="./tablas/tabla_${n}.png" class="bingo-card-image w-48 mx-auto mb-2" onerror="this.src='https://placehold.co/200?text=${n}'"><p class="font-bold text-${col}-600 text-xl">${st}</p>${d && d.name ? `<p class="text-sm text-gray-600">Jugador: ${d.name}</p>` : ''}<a href="./tablas/tabla_${n}.png" download class="inline-block mt-2 bg-purple-600 text-white px-4 py-1 rounded">Descargar</a></div>`;
        }

        function copyToClipboard(txt) {
            navigator.clipboard.writeText(txt);
            alert("Copiado!");
        }

                function handleLogoClick() {
    adminClicks++;
    if (adminClicks >= 6) {
        const adminPanel = document.getElementById('adminPanel');
        const clientContent = document.getElementById('clientContent');
        
        clientContent.classList.add('hidden');
        adminPanel.classList.remove('hidden');

        if (auth.currentUser) {
            document.getElementById('adminLogin').classList.add('hidden');
            document.getElementById('adminDashboard').classList.remove('hidden');
            // Cargar todas las listas del admin
            loadLineStats();
            renderAdminLinePending();
            renderAdminPendingList();
            renderAdminSoldList();
        } else {
            document.getElementById('adminLogin').classList.remove('hidden');
            document.getElementById('adminDashboard').classList.add('hidden');
        }
        adminClicks = 0;
    }
}
                function adminLogin() {
    const e = document.getElementById('adminEmail').value;
    const p = document.getElementById('adminPassword').value;
    
    if (!e || !p) {
        document.getElementById('adminLoginError').textContent = "Por favor, completa todos los campos.";
        document.getElementById('adminLoginError').classList.remove('hidden');
        return;
    }
    
    auth.signInWithEmailAndPassword(e, p).then(() => {
        document.getElementById('adminLogin').classList.add('hidden');
        document.getElementById('adminDashboard').classList.remove('hidden');
        
        // Cargar todas las listas
        renderAdminPendingList(); 
        renderAdminSoldList();
        loadLineStats();
        renderAdminLinePending();
        
    }).catch(err => {
        document.getElementById('adminLoginError').textContent = "Error: " + err.message;
        document.getElementById('adminLoginError').classList.remove('hidden');
    });
}

        function adminLogout() { auth.signOut().then(() => location.reload()); }

        function renderAdminPendingList() {
            db.collection('reservasPendientes').where('status', '==', 'PENDING_CONFIRMATION').onSnapshot(snap => {
                const div = document.getElementById('pendingCardsList');
                div.innerHTML = '';
                document.getElementById('pendingCount').textContent = snap.size;
                snap.forEach(doc => {
                    const d = doc.data();
                    div.innerHTML += `<div class="bg-white p-4 rounded-lg shadow border-l-4 border-yellow-400"><div class="flex justify-between mb-2"><span class="font-bold text-gray-800">${d.name}</span><span class="text-sm bg-gray-200 px-2 rounded">${d.phone}</span></div><p class="text-sm text-gray-600 mb-1">Ref: <b>${d.reference}</b> | Bs. ${d.totalAmount}</p><p class="text-sm mb-2">Tablas: <b class="text-purple-600">${d.cards.join(', ')}</b> | Sala: <b>${d.sala || 'N/A'}</b></p><a href="${d.proofURL}" target="_blank" class="block text-center bg-blue-50 text-blue-600 py-1 rounded text-sm font-bold mb-3 border border-blue-200">Ver Comprobante</a><div class="flex gap-2"><button onclick="confirmSale('${doc.id}')" class="flex-1 bg-green-500 text-white py-2 rounded font-bold hover:bg-green-600">APROBAR</button><button onclick="rejectSale('${doc.id}')" class="flex-1 bg-red-500 text-white py-2 rounded font-bold hover:bg-red-600">RECHAZAR</button></div></div>`;
                });
            });
        }

        function renderAdminSoldList() {
            db.collection('ventasConfirmadas').orderBy('saleDate', 'desc').limit(50).onSnapshot(snap => {
                const tbody = document.getElementById('soldPlayersTableBody');
                tbody.innerHTML = '';
                document.getElementById('soldCount').textContent = snap.size;
                snap.forEach(doc => {
                    const d = doc.data();
                    tbody.innerHTML += `<tr class="border-b hover:bg-gray-50"><td class="p-3 font-bold">${d.name}</td><td class="p-3 text-xs">${d.phone}</td><td class="p-3 text-green-600 font-bold text-xs break-all">${d.cards.join(',')}</td><td class="p-3"><button onclick="deleteSale('${doc.id}')" class="text-red-500 text-xs underline">Eliminar</button></td></tr>`;
                });
            });
        }

        function confirmSale(id) {
            if(!confirm("¬øConfirmar pago y vender tablas?")) return;

            db.collection('reservasPendientes').doc(id).get().then(doc => {
                if (!doc.exists) return alert("Error: La reserva ya no existe.");
                const d = doc.data();
                
                let conflict = false;
                let cardsToSell = [];

                d.cards.forEach(cardNum => {
                    const currentStatus = liveData[cardNum]?.status;
                    const currentReservationId = liveData[cardNum]?.reservationId;

                    if (currentStatus === 'sold') {
                        conflict = true;
                    } else if (currentStatus === 'reserved' && currentReservationId !== id) {
                        conflict = true;
                    } else {
                        cardsToSell.push(cardNum);
                    }
                });
                
                if (conflict) {
                    alert(`‚õî ERROR: Algunas tablas ya est√°n Vendidas o Reservadas. Solo se confirmar√°n: ${cardsToSell.join(', ')}.`);
                }

                if (cardsToSell.length === 0) {
                    alert("üö´ Ninguna tabla disponible para venta.");
                }
                
                const batch = db.batch();
                
                if (cardsToSell.length > 0) {
                    batch.set(db.collection('ventasConfirmadas').doc(), {
                        name: d.name,
                        phone: d.phone,
                        cards: cardsToSell,
                        saleDate: firebase.firestore.FieldValue.serverTimestamp()
                    });
                }
                
                batch.delete(db.collection('reservasPendientes').doc(id));
                
                batch.commit().then(() => {
                    alert(cardsToSell.length > 0 ? `Venta confirmada: ${cardsToSell.join(', ')}.` : "Reserva eliminada.");
                }).catch(e => {
                    console.error("Error:", e);
                    alert("Error al confirmar venta.");
                });
            });
        }

        function rejectSale(id) {
            if(confirm("¬øRechazar y liberar tablas?")) {
                db.collection('reservasPendientes').doc(id).delete().then(() => {
                    alert("Reserva rechazada.");
                }).catch(e => console.error("Error:", e));
            }
        }
        
        function deleteSale(id) {
            if(confirm("¬øEliminar venta?")) {
                db.collection('ventasConfirmadas').doc(id).delete().then(() => {
                    alert("Venta eliminada.");
                }).catch(e => console.error("Error:", e));
            }
        }
        
        function downloadSoldList() {
            db.collection('ventasConfirmadas').get().then(snap => {
                let csv = "Nombre,Telefono,Tablas\n";
                snap.forEach(doc => {
                    const d = doc.data();
                    csv += `${d.name || ''},${d.phone || ''},"${(d.cards || []).join(';')}"\n`;
                });
                const blob = new Blob([csv],{type:'text/csv'});
                const a = document.createElement('a');
                a.href = URL.createObjectURL(blob);
                a.download = 'ventas_omega.csv';
                a.click();
            });
        }

// ============================================
// FUNCIONES PARA PANEL DE ADMINISTRADOR - L√çNEAS
// ============================================

function loadLineStats() {
    const listas = ['picante', 'comun', 'fuego', 'dragon'];
    
    listas.forEach(lista => {
        db.collection('lineasReserva').doc(lista).onSnapshot(doc => {
            if (doc.exists) {
                const data = doc.data();
                const numeros = data.numeros || {};
                
                // Contar por estado
                let libres = 0, reservados = 0, vendidos = 0;
                Object.values(numeros).forEach(num => {
                    if (num.estado === 'libre') libres++;
                    else if (num.estado === 'reservado') reservados++;
                    else if (num.estado === 'vendido') vendidos++;
                });
                
                // Actualizar UI
                const total = libres + reservados + vendidos;
                const elem = document.getElementById(`lineStats${capitalizeFirstLetter(lista)}`);
                if (elem) {
                    elem.innerHTML = `
                        <div class="text-lg font-black">${total} n√∫meros</div>
                        <div class="flex justify-between text-xs mt-1">
                            <span class="text-green-600 font-bold">${libres} libres</span>
                            <span class="text-orange-600 font-bold">${reservados} reservados</span>
                            <span class="text-blue-600 font-bold">${vendidos} vendidos</span>
                        </div>
                        <div class="mt-2 flex flex-col gap-1">
                            <button onclick="resetLineList('${lista}')" class="w-full bg-red-500 text-white text-xs py-1 px-2 rounded font-bold hover:bg-red-600">
                                üîÑ Reiniciar Lista
                            </button>
                            <button onclick="showFreeNumberModal('${lista}')" class="w-full bg-blue-500 text-white text-xs py-1 px-2 rounded font-bold hover:bg-blue-600">
                                ‚ùå Liberar N√∫mero
                            </button>
                        </div>
                    `;
                }
            } else {
                // Si no existe, inicializar
                initializeLineList(lista);
            }
        });
    });
}

function capitalizeFirstLetter(string) {
    return string.charAt(0).toUpperCase() + string.slice(1);
}

// Funci√≥n para reiniciar una lista espec√≠fica
function resetLineList(lista) {
    if (!confirm(`¬øEst√°s seguro de reiniciar la lista ${lineNames[lista]}? Esto liberar√° TODOS los n√∫meros.`)) {
        return;
    }
    
    // Crear objeto con todos los n√∫meros en estado libre
    const updates = {};
    for (let i = 1; i <= 15; i++) {
        updates[`numeros.${i}`] = {
            estado: 'libre',
            jugadorNombre: null,
            jugadorTelefono: null,
            reservaId: null,
            timestamp: null
        };
    }
    
    db.collection('lineasReserva').doc(lista).update(updates)
        .then(() => {
            alert(`‚úÖ Lista ${lineNames[lista]} reiniciada correctamente.`);
            
            // Eliminar tambi√©n todas las reservas pendientes de esta lista
            db.collection('lineasReservasPendientes').where('lista', '==', lista).get()
                .then(snap => {
                    snap.forEach(doc => {
                        doc.ref.delete();
                    });
                });
        })
        .catch(error => {
            console.error("Error al reiniciar lista:", error);
            alert("‚ùå Error al reiniciar la lista.");
        });
}

// Funci√≥n para reiniciar todas las listas (que ya existe pero vamos a mejorarla)
function resetAllLines() {
    if (!confirm("¬øEst√°s seguro de reiniciar TODAS las listas de l√≠neas? Esto liberar√° TODOS los n√∫meros de todas las listas.")) {
        return;
    }
    
    const listas = ['picante', 'comun', 'fuego', 'dragon'];
    let promises = [];
    
    listas.forEach(lista => {
        const updates = {};
        for (let i = 1; i <= 15; i++) {
            updates[`numeros.${i}`] = {
                estado: 'libre',
                jugadorNombre: null,
                jugadorTelefono: null,
                reservaId: null,
                timestamp: null
            };
        }
        promises.push(db.collection('lineasReserva').doc(lista).update(updates));
    });
    
    Promise.all(promises)
        .then(() => {
            // Eliminar todas las reservas pendientes
            return db.collection('lineasReservasPendientes').get();
        })
        .then(snap => {
            snap.forEach(doc => {
                doc.ref.delete();
            });
            alert("‚úÖ Todas las listas han sido reiniciadas y las reservas pendientes eliminadas.");
        })
        .catch(error => {
            console.error("Error al reiniciar listas:", error);
            alert("‚ùå Error al reiniciar las listas.");
        });
}

// Funci√≥n para liberar un n√∫mero espec√≠fico
function freeLineNumber(lista, numero) {
    const num = parseInt(numero);
    if (!num || num < 1 || num > 15) {
        alert("N√∫mero inv√°lido. Debe ser entre 1 y 15.");
        return;
    }
    
    const razon = prompt(`¬øPor qu√© quieres liberar el n√∫mero ${num} de la lista ${lineNames[lista]}?`, "El jugador cancel√≥");
    
    if (razon === null) return; // Usuario cancel√≥
    
    const update = {};
    update[`numeros.${num}`] = {
        estado: 'libre',
        jugadorNombre: null,
        jugadorTelefono: null,
        reservaId: null,
        timestamp: null
    };
    
    db.collection('lineasReserva').doc(lista).update(update)
        .then(() => {
            // Buscar y eliminar reservas pendientes que contengan este n√∫mero
            db.collection('lineasReservasPendientes').where('lista', '==', lista).where('numeros', 'array-contains', num).get()
                .then(snap => {
                    snap.forEach(doc => {
                        const data = doc.data();
                        // Si la reserva solo tiene este n√∫mero, eliminar
                        if (data.numeros.length === 1) {
                            doc.ref.delete();
                        } else {
                            // Si tiene m√°s n√∫meros, quitar este
                            const nuevosNumeros = data.numeros.filter(n => n !== num);
                            doc.ref.update({ 
                                numeros: nuevosNumeros,
                                total: nuevosNumeros.length * linePrices[lista]
                            });
                        }
                    });
                });
            
            alert(`‚úÖ N√∫mero ${num} liberado correctamente. Raz√≥n: ${razon}`);
        })
        .catch(error => {
            console.error("Error al liberar n√∫mero:", error);
            alert("‚ùå Error al liberar el n√∫mero.");
        });
}

// Funci√≥n para mostrar modal de liberar n√∫mero
function showFreeNumberModal(lista) {
    const listaNombre = lineNames[lista];
    let numerosDisponibles = '';
    
    // Obtener n√∫meros ocupados de esta lista
    db.collection('lineasReserva').doc(lista).get()
        .then(doc => {
            if (doc.exists) {
                const data = doc.data();
                const numeros = data.numeros || {};
                
                // Filtrar n√∫meros que NO est√©n libres
                const ocupados = [];
                Object.entries(numeros).forEach(([num, info]) => {
                    if (info.estado !== 'libre') {
                        ocupados.push({
                            numero: num,
                            estado: info.estado,
                            jugador: info.jugadorNombre || 'Sin nombre'
                        });
                    }
                });
                
                if (ocupados.length === 0) {
                    alert("‚úÖ Todos los n√∫meros est√°n libres en esta lista.");
                    return;
                }
                
                // Crear modal de selecci√≥n
                let modalHTML = `
                    <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                        <div class="bg-white rounded-lg p-6 max-w-md w-full mx-4">
                            <h3 class="text-xl font-bold text-gray-800 mb-4">Liberar N√∫mero - ${listaNombre}</h3>
                            <p class="text-sm text-gray-600 mb-4">Selecciona el n√∫mero a liberar:</p>
                            <div class="grid grid-cols-5 gap-2 mb-4">
                `;
                
                ocupados.forEach(item => {
                    modalHTML += `
                        <button onclick="freeLineNumber('${lista}', ${item.numero})" 
                                class="p-2 rounded ${item.estado === 'reservado' ? 'bg-orange-100 text-orange-800' : 'bg-green-100 text-green-800'} hover:opacity-80">
                            <div class="font-bold">${item.numero}</div>
                            <div class="text-xs">${item.estado}</div>
                        </button>
                    `;
                });
                
                modalHTML += `
                            </div>
                            <p class="text-xs text-gray-500 mb-4">* Se pedir√° confirmaci√≥n antes de liberar</p>
                            <button onclick="closeFreeNumberModal()" class="w-full bg-gray-300 text-gray-700 py-2 rounded font-bold">
                                Cancelar
                            </button>
                        </div>
                    </div>
                `;
                
                // Crear y mostrar modal
                const modalDiv = document.createElement('div');
                modalDiv.id = 'freeNumberModal';
                modalDiv.innerHTML = modalHTML;
                document.body.appendChild(modalDiv);
            }
        });
}

function closeFreeNumberModal() {
    const modal = document.getElementById('freeNumberModal');
    if (modal) {
        modal.remove();
    }
}

// Funci√≥n mejorada para renderizar reservas pendientes de l√≠neas
function renderAdminLinePending() {
    db.collection('lineasReservasPendientes').where('estado', '==', 'pendiente')
        .onSnapshot(snap => {
            const div = document.getElementById('linePendingList');
            if (!div) return;
            
            div.innerHTML = '';
            document.getElementById('linePendingCount').textContent = snap.size;
            
            if (snap.size === 0) {
                div.innerHTML = '<p class="text-center text-gray-500 py-4">No hay reservas pendientes de l√≠neas.</p>';
                return;
            }
            
            snap.forEach(doc => {
                const d = doc.data();
                div.innerHTML += `
                    <div class="bg-white p-4 rounded-lg shadow border-l-4 border-yellow-400">
                        <div class="flex justify-between mb-2">
                            <span class="font-bold text-gray-800">${d.nombre || 'Sin nombre'}</span>
                            <span class="text-sm bg-gray-200 px-2 rounded">${d.telefono || 'Sin tel√©fono'}</span>
                        </div>
                        <p class="text-sm text-gray-600 mb-1">Lista: <b>${lineNames[d.lista]}</b></p>
                        <p class="text-sm mb-1">N√∫meros: <b class="text-purple-600">${(d.numeros || []).join(', ')}</b></p>
                        <p class="text-sm mb-2">Total: <b class="text-green-600">Bs. ${d.total || 0}</b></p>
                        <p class="text-sm mb-2">Ref: <b>${d.referencia || 'Sin referencia'}</b></p>
                        ${d.comprobanteURL ? `
                        <a href="${d.comprobanteURL}" target="_blank" class="block text-center bg-blue-50 text-blue-600 py-1 rounded text-sm font-bold mb-3 border border-blue-200">
                            üì∏ Ver Comprobante
                        </a>
                        ` : ''}
                        <div class="flex gap-2">
                            <button onclick="confirmLineSale('${doc.id}', '${d.lista}', ${JSON.stringify(d.numeros || [])}, '${d.nombre || ''}', '${d.telefono || ''}')" 
                                    class="flex-1 bg-green-500 text-white py-2 rounded font-bold hover:bg-green-600">
                                ‚úÖ APROBAR
                            </button>
                            <button onclick="rejectLineSale('${doc.id}', '${d.lista}', ${JSON.stringify(d.numeros || [])})" 
                                    class="flex-1 bg-red-500 text-white py-2 rounded font-bold hover:bg-red-600">
                                ‚ùå RECHAZAR
                            </button>
                        </div>
                    </div>
                `;
            });
        }, error => {
            console.error("Error al cargar reservas pendientes:", error);
            document.getElementById('linePendingList').innerHTML = '<p class="text-center text-red-500 py-4">Error al cargar reservas.</p>';
        });
}

// Funci√≥n para confirmar venta de l√≠nea (APROBAR)
function confirmLineSale(reservationId, lista, numeros, nombre, telefono) {
    const nums = JSON.parse(numeros);
    if (!confirm(`¬øConfirmar venta de los n√∫meros ${nums.join(', ')} en ${lineNames[lista]} para ${nombre} (${telefono})?`)) return;
    
    // Actualizar n√∫meros a "vendido"
    const updates = {};
    nums.forEach(num => {
        updates[`numeros.${num}`] = {
            estado: 'vendido',
            jugadorNombre: nombre,
            jugadorTelefono: telefono,
            reservaId: reservationId,
            timestamp: new Date().toISOString()
        };
    });
    
    db.collection('lineasReserva').doc(lista).update(updates)
        .then(() => {
            // Mover a ventas confirmadas
            return db.collection('lineasReservasPendientes').doc(reservationId).get();
        })
        .then(doc => {
            if (!doc.exists) return;
            
            const data = doc.data();
            return db.collection('lineasVentasConfirmadas').add({
                ...data,
                fechaConfirmacion: new Date().toISOString(),
                estado: 'confirmado',
                confirmadoPor: auth.currentUser.email
            });
        })
        .then(() => {
            // Eliminar de pendientes
            return db.collection('lineasReservasPendientes').doc(reservationId).delete();
        })
        .then(() => {
            alert('‚úÖ Venta confirmada correctamente.');
        })
        .catch(error => {
            console.error("Error confirmando venta de l√≠nea:", error);
            alert('‚ùå Error al confirmar la venta.');
        });
}

// Funci√≥n para rechazar reserva de l√≠nea
function rejectLineSale(reservationId, lista, numeros) {
    const nums = JSON.parse(numeros);
    const razon = prompt("¬øPor qu√© rechazas esta reserva?", "Pago no verificado");
    
    if (razon === null) return; // Usuario cancel√≥
    
    // Liberar n√∫meros
    const updates = {};
    nums.forEach(num => {
        updates[`numeros.${num}`] = {
            estado: 'libre',
            jugadorNombre: null,
            jugadorTelefono: null,
            reservaId: null,
            timestamp: null
        };
    });
    
    db.collection('lineasReserva').doc(lista).update(updates)
        .then(() => {
            // Eliminar reserva pendiente
            return db.collection('lineasReservasPendientes').doc(reservationId).delete();
        })
        .then(() => {
            alert(`‚ùå Reserva rechazada. Raz√≥n: ${razon}`);
        })
        .catch(error => {
            console.error("Error rechazando reserva de l√≠nea:", error);
            alert('‚ùå Error al rechazar la reserva.');
        });
}
        
        function startBingoTimer() {
            const countdownDisplay = document.getElementById('countdownTimer');

            const timerFunction = () => {
                const now = new Date().getTime();
                const dist = BINGO_DATE - now;

                if (dist < 0) {
                    countdownDisplay.textContent = "¬°JUEGO EN VIVO! üéâ";
                    return;
                }

                const oneDay = 1000 * 60 * 60 * 24;
                const oneHour = 1000 * 60 * 60;
                const oneMinute = 1000 * 60;

                const days = Math.floor(dist / oneDay);
                const hours = Math.floor((dist % oneDay) / oneHour);
                const minutes = Math.floor((dist % oneHour) / oneMinute);
                const seconds = Math.floor((dist % oneMinute) / 1000);

                const dDisplay = days > 0 ? `${days}D ` : '';
                const hDisplay = String(hours).padStart(2, '0');
                const mDisplay = String(minutes).padStart(2, '0');
                const sDisplay = String(seconds).padStart(2, '0');

                countdownDisplay.textContent = `${dDisplay}${hDisplay}:${mDisplay}:${sDisplay}`;
            };

            timerFunction();
            setInterval(timerFunction, 1000);
        }

        const legalContent = {
            terms: `
                <h2 class="text-xl font-bold text-gray-900 mb-3">T√©rminos y Condiciones del Servicio OMEGA Bingo</h2>
                <p class="text-xs text-gray-500 mb-4">√öltima actualizaci√≥n: 04/12/25</p>
                
                <h3 class="font-bold text-lg text-purple-700 mt-4 mb-2">1. Aceptaci√≥n de los T√©rminos</h3>
                <p>Al acceder y utilizar los servicios de OMEGA Bingo, usted acepta estar sujeto a estos T√©rminos y Condiciones, as√≠ como a nuestra Pol√≠tica de Privacidad.</p>
                
                <h3 class="font-bold text-lg text-purple-700 mt-4 mb-2">2. Uso de la Cuenta y Seguridad</h3>
                <p>Usted es responsable de mantener la confidencialidad de su contrase√±a y de todas las actividades que ocurran bajo su cuenta. Se compromete a notificarnos inmediatamente sobre cualquier uso no autorizado de su cuenta.</p>
                
                <h3 class="font-bold text-lg text-purple-700 mt-4 mb-2">3. Jurisdicci√≥n y Uso Legal (Venezuela / EEUU)</h3>
                <ul class="list-disc list-inside space-y-1 ml-4">
                    <li><strong>Juegos de Azar:</strong> Al participar, usted declara que cumple con la mayor√≠a de edad legal para participar en juegos de azar en su jurisdicci√≥n. Es su responsabilidad asegurarse de que la participaci√≥n en bingos en l√≠nea es legal en su lugar de residencia, tanto en Venezuela como en Estados Unidos, o cualquier otra ubicaci√≥n.</li>
                    <li><strong>Riesgo:</strong> La participaci√≥n es bajo su propio riesgo. OMEGA Bingo no se hace responsable por cualquier p√©rdida incurrida.</li>
                </ul>
                
                <h3 class="font-bold text-lg text-purple-700 mt-4 mb-2">4. Verificaci√≥n y Documentaci√≥n del Cliente</h3>
                <p>Para garantizar la integridad del juego y la seguridad de las transacciones, podemos solicitar documentaci√≥n adicional (como comprobantes de pago o identificaci√≥n) para verificar su identidad y sus reservas. Esta informaci√≥n ser√° tratada de acuerdo con nuestra Pol√≠tica de Privacidad.</p>

                <h3 class="font-bold text-lg text-purple-700 mt-4 mb-2">5. Uso del C√≥digo y Licencia</h3>
                <p>El c√≥digo fuente y los elementos de dise√±o (im√°genes, logos, etc.) de esta plataforma son propiedad privada de OMEGA Bingo Masson¬© o sus licenciatarios. El acceso a este sistema est√° estrictamente limitado al uso como cliente para la compra de tablas. Queda terminantemente prohibida la copia, reproducci√≥n, distribuci√≥n, ingenier√≠a inversa o cualquier uso no autorizado del c√≥digo privado de la p√°gina web sin el consentimiento expreso y por escrito de los propietarios de OMEGA Bingo.</p>
                
                <h3 class="font-bold text-lg text-purple-700 mt-4 mb-2">6. Limitaci√≥n de Responsabilidad</h3>
                <p>OMEGA Bingo no se hace responsable de las p√©rdidas o da√±os que surjan de la falta de medidas de seguridad adecuadas en los dispositivos del usuario, o de fallos t√©cnicos fuera de nuestro control razonable, incluyendo interrupciones en el servicio de Internet, fallos de red o errores de pago m√≥vil de terceros.</p>
                `,
            privacy: `
                <h2 class="text-xl font-bold text-gray-900 mb-3">Pol√≠tica de Privacidad de OMEGA Bingo</h2>
                <p class="text-xs text-gray-500 mb-4">√öltima actualizaci√≥n: 4/12/25</p>
                
                <h3 class="font-bold text-lg text-purple-700 mt-4 mb-2">1. Informaci√≥n que Recopilamos</h3>
                <p>Recopilamos informaci√≥n que usted nos proporciona directamente al registrarse, reservar n√∫meros y realizar pagos. Esto puede incluir su nombre, direcci√≥n de correo electr√≥nico, n√∫mero de tel√©fono, detalles de pago y los documentos de verificaci√≥n (como comprobantes de pago) que nos env√≠e.</p>
                
                <h3 class="font-bold text-lg text-purple-700 mt-4 mb-2">2. Uso de la Informaci√≥n y Cumplimiento Legal</h3>
                <ul class="list-disc list-inside space-y-1 ml-4">
                    <li>Procesar sus reservas y pagos.</li>
                    <li>Verificar su identidad y elegibilidad para jugar.</li>
                    <li>Comunicarnos con usted sobre el estado de su cuenta y premios.</li>
                    <li>Cumplir con nuestras obligaciones legales y reglamentarias, especialmente las relacionadas con la prevenci√≥n de fraude y el juego responsable, en las jurisdicciones aplicables (incluyendo Venezuela y EEUU).</li>
                </ul>

                <h3 class="font-bold text-lg text-purple-700 mt-4 mb-2">3. Almacenamiento y Seguridad de los Datos (Clave de Confianza)</h3>
                <p>La seguridad de su informaci√≥n personal es nuestra prioridad. Implementamos medidas de seguridad t√©cnicas y organizativas robustas para proteger los datos contra el acceso no autorizado, la alteraci√≥n, la divulgaci√≥n o la destrucci√≥n.</p>
                <ul class="list-disc list-inside space-y-1 ml-4">
                    <li><strong>Alojamiento Seguro:</strong> Todos los datos y documentos de verificaci√≥n (comprobantes de pago) se almacenan en servidores seguros operados por proveedores de servicios certificados que cumplen con est√°ndares de seguridad reconocidos internacionalmente ISO 27001., que manejan la informaci√≥n de acuerdo a est√°ndares globales.</li>
                    <li><strong>Cifrado:</strong> Utilizamos el cifrado de datos (SSL/TLS) para proteger la transmisi√≥n de datos entre su navegador y nuestros servidores. Los datos almacenados tambi√©n est√°n sujetos a medidas de cifrado en reposo cuando es posible.</li>
                    <li><strong>Acceso Restringido:</strong> El acceso a la informaci√≥n personal identificable est√° estrictamente limitado al personal autorizado de OMEGA Bingo que requiere acceso para realizar sus funciones laborales.</li>
                    <li><strong>Gesti√≥n de Documentos:</strong> Los comprobantes de clientes se almacenan en un sistema de gesti√≥n de documentos seguro e interno (Cloudinary privado) y nunca en servicios de alojamiento de archivos p√∫blicos o gen√©ricos como MediaFire, Google Drive personal o Dropbox personal.</li>
                </ul>
                
                <h3 class="font-bold text-lg text-purple-700 mt-4 mb-2">4. Retenci√≥n de Datos</h3>
                <p>Retenemos su informaci√≥n personal solo durante el tiempo necesario para cumplir con los fines para los que fue recopilada, incluyendo cualquier per√≠odo de retenci√≥n legal o reglamentario requerido por las autoridades de licencias de juego y fiscales.</p>
                `
        };

        function showLegalModal(type) {
            const modal = document.getElementById('legalModal');
            const title = document.getElementById('legalModalTitle');
            const body = document.getElementById('legalModalBody');

            if (type === 'terms') {
                title.textContent = 'T√©rminos y Condiciones';
                body.innerHTML = legalContent.terms;
            } else if (type === 'privacy') {
                title.textContent = 'Pol√≠tica de Privacidad';
                body.innerHTML = legalContent.privacy;
            }
            
            modal.style.display = 'flex';
        }

        function hideLegalModal() {
            document.getElementById('legalModal').style.display = 'none';
        }

            // ============================================
    // FUNCIONES FALTANTES (AGREGAR AL FINAL)
    // ============================================

    function saveLocalSelection() {
        localStorage.setItem('omega_selected_cards', JSON.stringify(selectedCards));
    }

    function checkStoreStatus() {
        // Verifica en la base de datos si la tienda debe estar cerrada o abierta
        db.collection('config').doc('general').onSnapshot((doc) => {
            if (doc.exists) {
                isStoreOpen = doc.data().isStoreOpen;
            } else {
                // Si no existe la configuraci√≥n, asumimos que est√° abierta
                isStoreOpen = true; 
            }
            updateStoreUI();
        }, (error) => {
            console.log("Error verificando estado de tienda:", error);
            isStoreOpen = true;
            updateStoreUI();
        });
    }

// ============================================
// FUNCIONES PARA RESERVA DE L√çNEAS
// ============================================

function openLineReservationModal() {
    hideAllModals();
    document.getElementById('lineReservationModal').style.display = 'flex';
    loadLineData();
    switchLineTab('picante');
    updateLineSelectionUI();
}

function hideLineReservationModal() {
    document.getElementById('lineReservationModal').style.display = 'none';
    resetLineSelection();
}

function hideLinePaymentModal() {
    document.getElementById('linePaymentModal').style.display = 'none';
    localStorage.removeItem('omega_line_payment_start');
    clearInterval(linePaymentTimerInterval);
}

function hideAllModals() {
    document.getElementById('cardSelectionModal').style.display = 'none';
    document.getElementById('paymentProcessModal').style.display = 'none';
    document.getElementById('legalModal').style.display = 'none';
    document.getElementById('lineReservationModal').style.display = 'none';
    document.getElementById('linePaymentModal').style.display = 'none';
}

function switchLineTab(tabName) {
    currentLineTab = tabName;
    
    // Ocultar todos los contenidos
    document.querySelectorAll('.tab-content-line').forEach(tab => {
        tab.classList.add('hidden');
    });
    
    // Mostrar el contenido seleccionado
    document.getElementById(`tab-content-${tabName}`).classList.remove('hidden');
    
    // Actualizar tabs activos
    document.querySelectorAll('.tab-line').forEach(tab => {
        if (tab.dataset.tab === tabName) {
            tab.classList.add('active');
            tab.style.borderBottomColor = '#7c3aed';
            tab.style.color = '#7c3aed';
        } else {
            tab.classList.remove('active');
            tab.style.borderBottomColor = 'transparent';
            tab.style.color = '#6b7280';
        }
    });
    
    // Actualizar UI
    document.getElementById('current-line-name').textContent = lineNames[tabName];
    updateLineSelectionUI();
}

function loadLineData() {
    // Cargar datos de las 4 listas desde Firestore
    const listas = ['picante', 'comun', 'fuego', 'dragon'];
    
    listas.forEach(lista => {
        db.collection('lineasReserva').doc(lista).onSnapshot(doc => {
            if (doc.exists) {
                lineData[lista] = doc.data();
                renderLineNumbers(lista);
                checkLineAvailability(lista);
            } else {
                // Inicializar si no existe
                initializeLineList(lista);
            }
        });
    });
    
    // Escuchar notificaciones en tiempo real
    db.collection('lineasNotificaciones').orderBy('timestamp', 'desc').limit(5)
        .onSnapshot(snap => {
            snap.docChanges().forEach(change => {
                if (change.type === 'added') {
                    const data = change.doc.data();
                    showLineNotification(data.message, data.type);
                }
            });
        });
}

function initializeLineList(lista) {
    const defaultData = {
        lista: lista,
        partida: lista === 'dragon' ? 1 : 2,
        fecha: new Date().toLocaleDateString('es-ES'),
        precio: linePrices[lista],
        numeros: {},
        estado: 'activa'
    };
    
    // Crear 15 n√∫meros inicialmente libres
    for (let i = 1; i <= 15; i++) {
        defaultData.numeros[i] = {
            estado: 'libre',
            jugadorId: null,
            jugadorNombre: null,
            jugadorTelefono: null,
            reservaId: null,
            timestamp: null
        };
    }
    
    db.collection('lineasReserva').doc(lista).set(defaultData);
}

function renderLineNumbers(lista) {
    const container = document.getElementById(`line-numbers-${lista}`);
    if (!container) return;
    
    container.innerHTML = '';
    const data = lineData[lista];
    if (!data || !data.numeros) return;
    
    for (let i = 1; i <= 15; i++) {
        const numData = data.numeros[i] || { estado: 'libre' };
        const isSelected = selectedLineNumbers[lista].includes(i);
        
        const div = document.createElement('div');
        div.className = 'line-number-container';
        div.innerHTML = `
            <div class="line-number ${numData.estado} ${isSelected ? 'seleccionado' : ''}" 
                 onclick="selectLineNumber('${lista}', ${i}, '${numData.estado}')">
                ${i}
            </div>
            <span class="line-status-tag" style="background-color: ${getLineStatusColor(numData.estado)}; color: white;">
                ${getLineStatusText(numData.estado, numData.jugadorNombre)}
            </span>
        `;
        
        container.appendChild(div);
    }
}

function getLineStatusColor(status) {
    switch(status) {
        case 'libre': return '#6b21a8';
        case 'reservado': return '#f97316';
        case 'vendido': return '#16a34a';
        default: return '#6b7280';
    }
}

function getLineStatusText(status, jugador) {
    switch(status) {
        case 'libre': return 'LIBRE';
        case 'reservado': return 'OCUPADO';
        case 'vendido': return jugador ? `VENDIDO` : 'VENDIDO';
        default: return 'ERROR';
    }
}

function selectLineNumber(lista, num, estado) {
    if (estado === 'libre') {
        // Alternar selecci√≥n
        const index = selectedLineNumbers[lista].indexOf(num);
        if (index > -1) {
            selectedLineNumbers[lista].splice(index, 1);
        } else {
            selectedLineNumbers[lista].push(num);
        }
        
        // Actualizar UI
        renderLineNumbers(lista);
        updateLineSelectionUI();
        playSelectionSound();
    } else if (estado === 'reservado' || estado === 'vendido') {
        // Mostrar informaci√≥n del jugador
        const data = lineData[lista].numeros[num];
        const jugador = data.jugadorNombre || 'Otro jugador';
        alert(`‚ö†Ô∏è El n√∫mero ${num} est√° ${estado === 'reservado' ? 'reservado' : 'vendido'} por: ${jugador}`);
    }
}

function updateLineSelectionUI() {
    const selected = selectedLineNumbers[currentLineTab];
    const count = selected.length;
    
    document.getElementById('selected-line-numbers').textContent = 
        count > 0 ? selected.join(', ') : 'Ninguno';
    
    const total = count * linePrices[currentLineTab];
    document.getElementById('line-total-cost').textContent = `Bs. ${total.toFixed(2)}`;
    
    // Habilitar/deshabilitar bot√≥n
    const btn = document.getElementById('btn-reserve-lines');
    if (count > 0) {
        btn.disabled = false;
        btn.classList.remove('opacity-50', 'cursor-not-allowed');
    } else {
        btn.disabled = true;
        btn.classList.add('opacity-50', 'cursor-not-allowed');
    }
}

function resetLineSelection() {
    selectedLineNumbers = {
        picante: [],
        comun: [],
        fuego: [],
        dragon: []
    };
}

function reserveSelectedLines() {
    const lista = currentLineTab;
    const selected = selectedLineNumbers[lista];
    
    if (selected.length === 0) {
        alert('Selecciona al menos un n√∫mero.');
        return;
    }
    
    // Verificar que los n√∫meros sigan libres
    let conflict = false;
    const data = lineData[lista];
    
    for (const num of selected) {
        if (data.numeros[num].estado !== 'libre') {
            conflict = true;
            break;
        }
    }
    
    if (conflict) {
        alert('‚ö†Ô∏è Algunos n√∫meros ya no est√°n disponibles. Actualizando lista...');
        renderLineNumbers(lista);
        return;
    }
    
    // Guardar reserva temporal
    currentLineReservation = {
        lista: lista,
        numeros: [...selected],
        total: selected.length * linePrices[lista]
    };
    
    // Mostrar modal de pago
    showLinePaymentModal();
}

function showLinePaymentModal() {
    hideLineReservationModal();
    
    // Actualizar informaci√≥n en el modal
    document.getElementById('payLineList').textContent = lineNames[currentLineReservation.lista];
    document.getElementById('payLineNumbers').textContent = currentLineReservation.numeros.join(', ');
    document.getElementById('payLineTotal').textContent = `Bs. ${currentLineReservation.total.toFixed(2)}`;
    
    // Limpiar formulario
    document.getElementById('linePayName').value = '';
    document.getElementById('linePayPhone').value = '';
    document.getElementById('linePayRef').value = '';
    document.getElementById('lineFileNameDisplay').textContent = '';
    document.getElementById('lineUploadStatus').classList.add('hidden');
    
    // Iniciar temporizador
    localStorage.setItem('omega_line_payment_start', Date.now());
    startLinePaymentTimer();
    
    // Mostrar modal
    document.getElementById('linePaymentModal').style.display = 'flex';
}

function startLinePaymentTimer() {
    const display = document.getElementById('linePaymentTimer');
    clearInterval(linePaymentTimerInterval);
    
    const startTime = parseInt(localStorage.getItem('omega_line_payment_start'));
    if (!startTime) return;
    
    linePaymentTimerInterval = setInterval(() => {
        const now = Date.now();
        const elapsedSeconds = Math.floor((now - startTime) / 1000);
        const totalDuration = 600; // 10 minutos
        let remaining = totalDuration - elapsedSeconds;
        
        if (remaining < 0) remaining = 0;
        
        const m = Math.floor(remaining / 60);
        const s = remaining % 60;
        display.textContent = `${m<10?'0':''}${m}:${s<10?'0':''}${s}`;
        
        if (remaining <= 0) {
            clearInterval(linePaymentTimerInterval);
            alert('‚è∞ Tiempo agotado. Los n√∫meros han sido liberados.');
            
            // Liberar n√∫meros
            freeLineReservation(currentLineReservation);
            
            hideLinePaymentModal();
            resetLineSelection();
        }
    }, 1000);
}

async function submitLinePayment() {
    const YOUR_CLOUD_NAME = "dcenrp74j";
    const YOUR_UPLOAD_PRESET = "bingo_comprobantes";
    
    const name = document.getElementById('linePayName').value.trim();
    const phone = document.getElementById('linePayPhone').value.replace(/\D/g, '');
    const ref = document.getElementById('linePayRef').value;
    const file = document.getElementById('linePayFile').files[0];
    const statusMsg = document.getElementById('lineUploadStatus');
    
    // Validaciones
    if (!name || phone.length < 10 || !ref || !file) {
        statusMsg.textContent = '‚ùå Completa todos los campos requeridos.';
        statusMsg.className = 'text-center text-sm mt-2 font-bold text-red-600 block';
        statusMsg.classList.remove('hidden');
        return;
    }
    
    // Verificar que los n√∫meros sigan libres
    const lista = currentLineReservation.lista;
    const selected = currentLineReservation.numeros;
    const data = lineData[lista];
    
    for (const num of selected) {
        if (data.numeros[num].estado !== 'libre') {
            statusMsg.textContent = `‚ùå El n√∫mero ${num} ya no est√° disponible.`;
            statusMsg.className = 'text-center text-sm mt-2 font-bold text-red-600 block';
            statusMsg.classList.remove('hidden');
            return;
        }
    }
    
    statusMsg.textContent = '‚è≥ Subiendo comprobante...';
    statusMsg.className = 'text-center text-sm mt-2 font-bold text-blue-600 block';
    statusMsg.classList.remove('hidden');
    
    try {
        // Subir imagen a Cloudinary
        const formData = new FormData();
        formData.append('file', file);
        formData.append('upload_preset', YOUR_UPLOAD_PRESET);
        formData.append('public_id', `lineas_${phone}_${Date.now()}`);
        
        const uploadUrl = `https://api.cloudinary.com/v1_1/${YOUR_CLOUD_NAME}/image/upload`;
        const response = await fetch(uploadUrl, { method: 'POST', body: formData });
        const data = await response.json();
        
        if (!response.ok || !data.secure_url) {
            throw new Error(data.error?.message || 'Error al subir imagen');
        }
        
        const proofURL = data.secure_url;
        const reservationId = `line_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
        
        // Crear reserva en Firestore
        await db.collection('lineasReservasPendientes').doc(reservationId).set({
            lista: currentLineReservation.lista,
            numeros: currentLineReservation.numeros,
            nombre: name,
            telefono: phone,
            referencia: ref,
            comprobanteURL: proofURL,
            total: currentLineReservation.total,
            timestamp: Date.now(),
            estado: 'pendiente',
            reservationId: reservationId
        });
        
        // Actualizar estado de los n√∫meros a "reservado"
        const updates = {};
        currentLineReservation.numeros.forEach(num => {
            updates[`numeros.${num}`] = {
                estado: 'reservado',
                jugadorNombre: name,
                jugadorTelefono: phone,
                reservaId: reservationId,
                timestamp: Date.now()
            };
        });
        
        await db.collection('lineasReserva').doc(currentLineReservation.lista).update(updates);
        
        // Notificaci√≥n en tiempo real
        await db.collection('lineasNotificaciones').add({
            message: `üéØ ${name} reserv√≥ los n√∫meros ${currentLineReservation.numeros.join(', ')} en ${lineNames[currentLineReservation.lista]}`,
            type: 'reserva',
            timestamp: Date.now()
        });
        
        // √âxito
        statusMsg.textContent = '‚úÖ ¬°Reserva enviada! Espera confirmaci√≥n del administrador.';
        statusMsg.className = 'text-center text-sm mt-2 font-bold text-green-600 block';
        
        // Confetti
        confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
        
        // Limpiar y cerrar despu√©s de 2 segundos
        setTimeout(() => {
            hideLinePaymentModal();
            resetLineSelection();
            localStorage.removeItem('omega_line_payment_start');
            clearInterval(linePaymentTimerInterval);
        }, 2000);
        
    } catch (error) {
        console.error('Error en reserva de l√≠neas:', error);
        statusMsg.textContent = `‚ùå Error: ${error.message}`;
        statusMsg.className = 'text-center text-sm mt-2 font-bold text-red-600 block';
    }
}

function freeLineReservation(reservation) {
    if (!reservation) return;
    
    const lista = reservation.lista;
    const numeros = reservation.numeros;
    
    // Actualizar n√∫meros a libres
    const updates = {};
    numeros.forEach(num => {
        updates[`numeros.${num}`] = {
            estado: 'libre',
            jugadorNombre: null,
            jugadorTelefono: null,
            reservaId: null,
            timestamp: null
        };
    });
    
    db.collection('lineasReserva').doc(lista).update(updates);
    
    // Notificaci√≥n
    db.collection('lineasNotificaciones').add({
        message: `üîÑ Se liberaron los n√∫meros ${numeros.join(', ')} en ${lineNames[lista]}`,
        type: 'liberacion',
        timestamp: Date.now()
    });
}

function showLineNotification(message, type) {
    const notification = document.createElement('div');
    notification.className = 'line-notification';
    notification.innerHTML = `
        <div class="flex items-center">
            <div class="mr-3 text-2xl">${type === 'reserva' ? 'üéØ' : type === 'venta' ? 'üí∞' : 'üîÑ'}</div>
            <div>
                <p class="font-bold text-sm">${message}</p>
                <p class="text-xs text-gray-500">Ahora mismo</p>
            </div>
        </div>
    `;
    
    document.body.appendChild(notification);
    
    // Mostrar
    setTimeout(() => notification.style.display = 'block', 100);
    
    // Ocultar despu√©s de 5 segundos
    setTimeout(() => {
        notification.style.opacity = '0';
        notification.style.transform = 'translateX(100%)';
        setTimeout(() => notification.remove(), 500);
    }, 5000);
}

function checkLineAvailability(lista) {
    // Verificar si la lista tiene n√∫meros libres
    const data = lineData[lista];
    if (!data) return;
    
    const numeros = data.numeros;
    const libres = Object.values(numeros).filter(n => n.estado === 'libre').length;
    
    // Si hay menos de 5 n√∫meros libres, marcar como "casi llena"
    if (libres < 5 && libres > 0) {
        // Podr√≠as agregar un indicador visual aqu√≠
        console.log(`${lista} casi llena - ${libres} n√∫meros libres`);
    }
}

function playSelectionSound() {
    // Efecto de sonido para selecci√≥n (puedes agregar un sonido real despu√©s)
    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
    const oscillator = audioContext.createOscillator();
    const gainNode = audioContext.createGain();
    
    oscillator.connect(gainNode);
    gainNode.connect(audioContext.destination);
    
    oscillator.frequency.value = 800;
    oscillator.type = 'sine';
    
    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
    
    oscillator.start(audioContext.currentTime);
    oscillator.stop(audioContext.currentTime + 0.1);
}

// ============================================
// FUNCIONES PARA PANEL DE ADMIN - L√çNEAS
// ============================================

function renderAdminLinePending() {
    // Similar a renderAdminPendingList pero para l√≠neas
    db.collection('lineasReservasPendientes').where('estado', '==', 'pendiente')
        .onSnapshot(snap => {
            const div = document.getElementById('linePendingList'); // Necesitar√°s agregar este div en el HTML del admin
            if (!div) return;
            
            div.innerHTML = '';
            snap.forEach(doc => {
                const d = doc.data();
                div.innerHTML += `
                    <div class="bg-white p-4 rounded-lg shadow border-l-4 border-yellow-400 mb-3">
                        <div class="flex justify-between mb-2">
                            <span class="font-bold text-gray-800">${d.nombre}</span>
                            <span class="text-sm bg-gray-200 px-2 rounded">${d.telefono}</span>
                        </div>
                        <p class="text-sm text-gray-600 mb-1">Lista: <b>${lineNames[d.lista]}</b></p>
                        <p class="text-sm mb-1">N√∫meros: <b class="text-purple-600">${d.numeros.join(', ')}</b></p>
                        <p class="text-sm mb-2">Total: <b class="text-green-600">Bs. ${d.total}</b></p>
                        <a href="${d.comprobanteURL}" target="_blank" class="block text-center bg-blue-50 text-blue-600 py-1 rounded text-sm font-bold mb-3 border border-blue-200">
                            Ver Comprobante
                        </a>
                        <div class="flex gap-2">
                            <button onclick="confirmLineSale('${doc.id}', '${d.lista}', ${JSON.stringify(d.numeros)})" 
                                    class="flex-1 bg-green-500 text-white py-2 rounded font-bold hover:bg-green-600">
                                APROBAR
                            </button>
                            <button onclick="rejectLineSale('${doc.id}', '${d.lista}', ${JSON.stringify(d.numeros)})" 
                                    class="flex-1 bg-red-500 text-white py-2 rounded font-bold hover:bg-red-600">
                                RECHAZAR
                            </button>
                        </div>
                    </div>
                `;
            });
        });
}

function confirmLineSale(reservationId, lista, numeros) {
    if (!confirm('¬øConfirmar venta de estas l√≠neas?')) return;
    
    // Actualizar n√∫meros a "vendido"
    const updates = {};
    numeros.forEach(num => {
        updates[`numeros.${num}.estado`] = 'vendido';
    });
    
    db.collection('lineasReserva').doc(lista).update(updates);
    
    // Mover a ventas confirmadas
    db.collection('lineasReservasPendientes').doc(reservationId).get()
        .then(doc => {
            const data = doc.data();
            db.collection('lineasVentasConfirmadas').add({
                ...data,
                fechaConfirmacion: Date.now(),
                estado: 'confirmado'
            });
            
            // Eliminar de pendientes
            doc.ref.delete();
            
            // Notificaci√≥n
            db.collection('lineasNotificaciones').add({
                message: `üí∞ VENTA CONFIRMADA: ${data.nombre} compr√≥ n√∫meros en ${lineNames[lista]}`,
                type: 'venta',
                timestamp: Date.now()
            });
            
            alert('‚úÖ Venta confirmada correctamente.');
        });
}

function rejectLineSale(reservationId, lista, numeros) {
    if (!confirm('¬øRechazar y liberar estas l√≠neas?')) return;
    
    // Liberar n√∫meros
    const updates = {};
    numeros.forEach(num => {
        updates[`numeros.${num}`] = {
            estado: 'libre',
            jugadorNombre: null,
            jugadorTelefono: null,
            reservaId: null,
            timestamp: null
        };
    });
    
    db.collection('lineasReserva').doc(lista).update(updates);
    
    // Eliminar reserva pendiente
    db.collection('lineasReservasPendientes').doc(reservationId).delete();
    
    // Notificaci√≥n
    db.collection('lineasNotificaciones').add({
        message: `üîÑ RESERVA RECHAZADA: Se liberaron n√∫meros en ${lineNames[lista]}`,
        type: 'liberacion',
        timestamp: Date.now()
    });
    
    alert('‚ùå Reserva rechazada y n√∫meros liberados.');
}
        
</script>
</body>
</html>
