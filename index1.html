<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OMEGA Bingo - Panel Oficial</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700;900&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <link rel="stylesheet" href="style.css">

    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
</head>
<body class="bg-light">

    <div class="container bg-white shadow-lg min-vh-100 px-0 px-md-3">

        <div id="adminPanel" class="admin-panel d-none p-4">
            <div class="d-flex justify-content-between align-items-center mb-4 bg-white border p-3 rounded-3 shadow-sm">
                <h1 class="h4 fw-black text-purple-800 m-0">üîê Panel OMEGA</h1>
                <button onclick="adminLogout()" class="btn btn-danger fw-bold">Salir</button>
            </div>

            <div id="adminLogin" class="mx-auto border p-4 rounded-4 shadow-sm" style="max-width: 400px;">
                <h2 class="h5 fw-bold mb-3 text-secondary text-center">Admin Login</h2>
                <input type="email" id="adminEmail" placeholder="Correo" class="form-control mb-3 py-2">
                <input type="password" id="adminPassword" placeholder="Contrase√±a" class="form-control mb-3 py-2">
                <button onclick="adminLogin()" class="btn btn-primary w-100 fw-bold py-2">ENTRAR</button>
                <p id="adminLoginError" class="text-danger small mt-2 d-none text-center"></p>
            </div>

            <div id="adminDashboard" class="d-none">
                <div class="card border-0 shadow-sm border-top border-warning border-5 mb-4">
                    <div class="card-body">
                        <h2 class="h5 fw-bold">‚ö†Ô∏è Pagos Pendientes (<span id="pendingCount">0</span>)</h2>
                        <div id="pendingCardsList" class="row g-3 mt-2"></div>
                    </div>
                </div>
                <div class="card border-0 shadow-sm border-top border-success border-5">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <h2 class="h5 fw-bold">‚úÖ Ventas (<span id="soldCount">0</span>)</h2>
                            <button onclick="downloadSoldList()" class="btn btn-sm btn-outline-primary fw-bold">Descargar CSV</button>
                        </div>
                        <div class="table-responsive">
                            <table class="table table-hover align-middle small">
                                <thead class="table-light text-uppercase">
                                    <tr><th>Nombre</th><th>Tlf</th><th>Tablas</th><th>Acci√≥n</th></tr>
                                </thead>
                                <tbody id="soldPlayersTableBody"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="clientContent" class="py-4">
            <div class="mx-auto mb-4" style="max-width: 600px;">
                <div class="bg-warning p-3 rounded-top text-center shadow-sm border-bottom border-dark border-4">
                    <p class="fw-black fs-4 m-0 text-dark">¬°OMEGA BINGO MAYOR!</p>
                </div>
                <div class="bg-primary p-3 rounded-bottom text-center text-white">
                    <p class="small fw-bold text-uppercase mb-1 opacity-75">Pr√≥ximo Juego: <span id="bingoDateDisplay">--</span></p>
                    <div id="countdownTimer" class="display-6 fw-black">--:--:--</div>
                </div>
            </div>

            <div class="row justify-content-center mb-4">
                <div class="col-11 col-md-8 text-center bg-white p-4 rounded-4 shadow-sm border">
                    <p class="text-secondary fw-bold mb-1">Valor de la Tabla</p>
                    <p class="display-5 fw-black text-success mb-2">Bs. 100,00</p>
                    <span class="badge rounded-pill bg-light text-primary border px-3 py-2 fw-bold">
                        Disponibles: <span id="availableCount">--</span>
                    </span>
                </div>
            </div>

            <div class="text-center my-5">
                <h1 class="display-1 fw-black text-warning logo-text" style="text-shadow: 4px 4px 0px #5b21b6;">OMEGA</h1>
                <p class="text-primary fw-bold text-uppercase tracking-widest">Sistema de Reserva Online</p>
            </div>

            <div class="row g-4 justify-content-center px-3">
                
                <div class="col-12 col-md-6 col-lg-5">
                    <div class="card border-0 shadow-sm border-start border-primary border-5 h-100">
                        <div class="card-body p-4">
                            <h3 class="h6 fw-bold mb-3 d-flex align-items-center">
                                <i class="fas fa-mobile-alt me-2 text-primary"></i> Datos Pago M√≥vil
                            </h3>
                            <div class="small">
                                <div class="d-flex justify-content-between border-bottom py-2 cursor-pointer" onclick="copyToClipboard('0108')">
                                    <span>Banco:</span> <span class="fw-bold">0108 (Provincial) <i class="fas fa-copy ms-1 opacity-50"></i></span>
                                </div>
                                <div class="d-flex justify-content-between border-bottom py-2 cursor-pointer" onclick="copyToClipboard('25822059')">
                                    <span>C√©dula:</span> <span class="fw-bold">V-25822059 <i class="fas fa-copy ms-1 opacity-50"></i></span>
                                </div>
                                <div class="d-flex justify-content-between py-2 cursor-pointer" onclick="copyToClipboard('04129546751')">
                                    <span>Tel√©fono:</span> <span class="fw-bold">04129546751 <i class="fas fa-copy ms-1 opacity-50"></i></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-12 col-md-6 col-lg-5 d-flex align-items-center">
                    <button onclick="showCardSelectionModal()" class="btn btn-warning w-100 py-4 shadow-lg rounded-4 fw-black fs-4 text-uppercase transform-hover">
                        Comprar Tablas üéüÔ∏è
                    </button>
                </div>

                <div class="col-12 col-md-10 col-lg-10">
                    <div class="row g-3">
                        <div class="col-12 col-md-6">
                            <div class="bg-white p-3 rounded-4 border shadow-sm">
                                <h3 class="h6 fw-bold text-muted mb-2 text-center">üîç Por Tel√©fono</h3>
                                <div class="input-group">
                                    <input type="tel" id="searchPhoneInput" placeholder="Ej: 0412..." class="form-control">
                                    <button onclick="searchCardByPhone()" class="btn btn-primary fw-bold">Ver</button>
                                </div>
                            </div>
                        </div>
                        <div class="col-12 col-md-6">
                            <div class="bg-white p-3 rounded-4 border shadow-sm">
                                <h3 class="h6 fw-bold text-muted mb-2 text-center">üÜî Por N¬∞ Tabla</h3>
                                <div class="input-group">
                                    <input type="number" id="cardNumberInput" placeholder="N¬∞" class="form-control">
                                    <button onclick="searchCard()" class="btn btn-primary fw-bold">Ver</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="searchResultArea" class="d-none mt-4 mx-3 p-4 bg-white rounded-4 border-dashed border-2 text-center border-primary shadow-sm">
                <h3 id="resultTitle" class="h6 fw-bold text-primary mb-3"></h3>
                <div id="resultContent" class="d-flex justify-content-center flex-wrap gap-2"></div>
                <p id="resultStatus" class="small fw-bold mt-2"></p>
            </div>

            <footer class="mt-5 pt-5 pb-4 text-center bg-dark text-white rounded-top-5">
                <img src="logo-omega-bingo.png" class="rounded-circle bg-white p-1 shadow mb-3" style="width: 80px;" alt="Logo">
                <h3 class="h5 fw-bold mb-4">S√≠guenos en Redes</h3>
                <div class="d-flex justify-content-center gap-4 mb-4">
                    <a href="https://wa.me/584226431972" target="_blank" class="text-success fs-2 transform-hover"><i class="fab fa-whatsapp"></i></a>
                    <a href="https://www.facebook.com/OmegabingoAA/" target="_blank" class="text-info fs-2 transform-hover"><i class="fab fa-facebook"></i></a>
                    <a href="https://www.instagram.com/omega_bingo" target="_blank" class="text-danger fs-2 transform-hover"><i class="fab fa-instagram"></i></a>
                </div>
                <div class="small opacity-50 mb-3">
                    <button onclick="showLegalModal('terms')" class="btn btn-link btn-sm text-warning p-0">T√©rminos</button> | 
                    <button onclick="showLegalModal('privacy')" class="btn btn-link btn-sm text-warning p-0">Privacidad</button>
                </div>
                <p class="x-small mb-0">¬© OMEGA Bingo 2025</p>
                <img src="logo-masson-bingo.png" class="mt-2" style="width: 60px;" alt="Masson">
            </footer>
        </div>
    </div>

    <div id="cardSelectionModal" class="modal-custom d-none">
        <div class="modal-content-custom bg-white p-4 rounded-4 shadow-lg mx-auto" style="max-width: 500px; margin-top: 5vh;">
            <div class="d-flex justify-content-between align-items-center mb-3 border-bottom pb-2">
                <h3 class="h5 fw-bold m-0">Selecciona tus Tablas</h3>
                <button onclick="hideCardSelectionModal()" class="btn-close"></button>
            </div>
            <div id="cardListContainer" class="row g-2 overflow-y-auto px-2" style="max-height: 50vh;"></div>
            <div class="mt-4 border-top pt-3">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <span class="fw-bold text-secondary">Total:</span>
                    <span id="totalCostDisplay" class="h4 fw-black text-success m-0">Bs. 0,00</span>
                </div>
                <button onclick="preparePayment()" class="btn btn-primary w-100 py-2 fw-bold rounded-3">CONTINUAR A PAGO</button>
            </div>
        </div>
    </div>

    <div id="paymentProcessModal" class="modal-custom d-none">
        <div class="modal-content-custom bg-white p-4 rounded-4 shadow-lg mx-auto" style="max-width: 450px; margin-top: 2vh;">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h3 class="h5 fw-bold text-primary m-0">Confirmar Pago</h3>
                <button onclick="hidePaymentModal()" class="btn-close"></button>
            </div>
            
            <div class="alert alert-warning border-warning small text-center mb-4">
                <p class="mb-1 fw-bold text-danger">‚è≥ Tienes <span id="paymentTimer">05:00</span> para el capture.</p>
                <p class="mb-0 text-muted">Env√≠a el pago y sube la foto abajo.</p>
            </div>

            <form id="paymentForm" onsubmit="event.preventDefault(); submitPayment();">
                <input type="text" id="payName" placeholder="Nombre y Apellido" class="form-control mb-2" required>
                <input type="tel" id="payPhone" placeholder="Tel√©fono (WhatsApp)" class="form-control mb-2" required>
                <input type="number" id="payRef" placeholder="√öltimos 4 d√≠gitos Referencia" class="form-control mb-3" required>
                
                <div class="border border-dashed border-primary rounded-3 p-3 text-center bg-light mb-3 position-relative">
                    <input type="file" id="payFile" accept="image/*" class="position-absolute top-0 start-0 w-100 h-100 opacity-0 cursor-pointer" required>
                    <p class="text-primary fw-bold mb-0">üì∏ Toca para subir CAPTURE</p>
                    <p id="fileNameDisplay" class="x-small text-muted mt-1"></p>
                </div>

                <button type="submit" class="btn btn-success w-100 py-3 fw-black text-uppercase shadow">ENVIAR COMPROBANTE üöÄ</button>
            </form>
            <p id="uploadStatus" class="text-center small mt-2 fw-bold d-none"></p>
        </div>
    </div>

    <div id="toast-notification" class="toast-hidden shadow-lg p-3 rounded-pill bg-white fw-bold">
        <span id="toast-message"></span>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="firebase-config.js"></script>
    <script src="script.js"></script>
</body>
</html>
